\chapter{Úvod}
Cílem této práce je popis technické realizace nástroje, který je zaměřen na provádění finanční analýzy vybraných ekonomických objektů. Součástí práce je i teorie spojená s~finanční analýzou v~rozsahu, který implementovaný nástroj pokrývá.

Finanční analýza je v~podnikové sféře soubor činností umožňující zjistit a~vyhodnotit finanční situaci podniku na základě dat o~jeho hospodaření. Existuje mnoho způsobů jak analýzu provádět a objektem analýzy můžou být i jiné entity z~oblasti ekonomie. Její provádění a~zkoumání výsledků je jedním z~předpokladů pro kvalitní a~komplexní vedení podniku. Cílovou skupinu produktu tedy tvoří finanční analytici, manažeři společností i běžní podnikatelé, jimž má usnadnit provádění této činnosti.

Práce obsahuje dva tematické celky. Nejprve bude provedeno shrnutí teorie spojené s~prováděním finanční analýzy -- co je to finanční analýza, jaké jsou její cíle, jaká jsou vstupní data a~co je výstupem, vysvětlení pojmů, používaných metod a~strategií, konstrukcí a~vypočtů jednotlivých ukazatelů finanční analýzy a~intepretací jejich hodnot. Druhým tematickým celkem je popis nástroje, který finanční analýzu provádí a~který bude v~rámci této diplomové práce implementován. 

Text práce je členěn do pěti kapitol. Jelikož je finanční analýza poměrně rozsáhlá oblast, celá příští kapitola je věnována prvnímu celku, teorii. 

Ve třetí kapitole jsou ještě před vytvářením vlastní koncepce podrobeny analýze již existující nástroje, abychom si mohli udělat obrázek o~tom, jak tuto problematiku řešili jiní. Na základě zjištěných poznatků je vypracován návrh programového řešení vlastního nástroje.

Čtvrtá kapitola se zabývá realizací návrhu, implementačními detaily a fungováním nástroje. Jsou zde zmíněny i návrhy na možná rozšíření.

V~závěrečné kapitole jsou shrnuty a~zhodnoceny dosažené výsledky a přínosy této práce.





























\chapter{Finanční analýza}


\section{Předmět, motivace a~cíle}
Finanční analýza podniku je metoda hodnocení finančního hospodaření podniku, při které se získaná data třídí, agregují, poměřují mezi sebou navzájem, kvantifikují se vztahy mezi nimi, hledají se mezi nimi kauzální souvisloti a~určuje se jejich vývoj. Tím se zvyšuje vypovídací schopnost zpracovávaných dat, zvyšuje se jejich informační hodnota.\cite{sedl}

Motivací je posouzení finanční situace podniku a~její příčiny, do jisté míry i k~predikci stavu podniku v~budoucnu, odhalení důsledků vlastních rozhodnutí, identifikaci slabých míst, plánování, zhodnocení hospodaření, vyvozování závěrů o~vlastnostech podniku, ohodnocení podniku a~vyvozování dalších užitečných informací.

Mimo to se v~praxi lze setkat s~případy, kdy je pro dosažení podnikatelského záměru provedení finanční analýzy nezbytné. Její výsledky jsou směrodatné například při rozhodování banky mezi poskytnutím a~neposkytnutím úvěru, pro vyměření výše úroků.

Při finanční analýze se používají dva navzájem propojené přístupy\cite{kova}:
\begin{enumerate}
	\item kvalitativní (fundamentální) analýza, založená na znalostech souvislostí mezi ekonomickými i mimoekonomickými jevy, zkušenostech odborníků a~na jejich subjektivních odhadech
	\item kvantitativní (technická) analýza, která využívá matematické, statistické a~jiné algoritmizovatelné postupy
\end{enumerate}

V~této práci se budeme zabývat především kvantitativní analýzou, právě z~důvodu možnosti její algoritmizace a tím pádem možnosti strojového provádění. Výstup této analýzy poté poslouží jako užitečný podklad pro analýzu kvalitativní, kterou provede samotný uživatel.


\begin{figure}
  \centering
  \includegraphics[width=14cm]{img/ccf.png}
  \caption{Schéma finančních toků podniku \cite{sedl}}
  \label{ccf}
\end{figure}

\section{Vstupní data}
Abychom mohli provést finanční analýzu podniku nebo investice, musíme mít data, ze kterých budeme vycházet. Množina vstupních dat není nijak omezena a~může být vskutku rozsáhlá -- při výpočtu a~odvozování závěrů lze zohlednit nejrůznější faktory, ekonomické i mimoekenomické. Pro nás budou však klíčová především data o~vlastním hospodaření podniku, za jejichž evidenci je zodpovědná účetní jednotka podniku, která je v~průběhu roku zapisuje do takzvané účtové osnovy. 

Při analýze investice se vychází především z~atributů investice, jako je například doba investice, úroková sazba a výnosy a výdaje s investicí spojené.

\subsubsection{Účtová osnova}
Právnické osoby, fyzické osoby zapsané v~obchodním rejistříku a~některé další subjekty jsou ze zákona o~účetnictví povinny vést podvojné účetnictví, což implikuje povinnost účtovat podle účtové osnovy. Všechny peněžní toky a~prostředky musí být evidovány na příslušném účtu. Přestože je účtů nespočet, obecně se dají rozdělit do dvou skupin -- rozvahové a~výsledovkové. Tyto subjekty jsou dále povinny každoročně vypracovat a~zveřejnit účetní závěrku, která je tvořena dvěmi finančními výkazy, rozvaha a~výkaz zisku a~ztráty (výsledovka). Hodnoty položek ve výkazu plynou právě ze sumy hodnot jednotlivých účtů účtové osnovy (rozvahových pro rozvahu, výsledovkových pro výsledovku).

Tyto dva výkazy jsou spolu s~přehledem o~pěněžních tocích stěžejním výstupem účetnictví:

\begin{itemize}
	\item výkaz zisku a ztrát -- finanční výkonnost podniku, zachycuje hodnoty a vztahy mezi výnosy podniku a náklady potřebných na jejich vytvoření
	\item rozvaha -- finanční pozice podniku, soupis majetku podniku v~peněžním vyjádření a zdrojů jeho financování
	\item přehled o~peněžních tocích -- zachycuje schopnosti a způsoby vytváření peněžních prostředků a jejich využití
\end{itemize}


Níže se zle dočíst, že součástí strukturovaných, každoročně odevzdávaných souborů jsou pouze výkaz zisku a ztrát a rozvaha, přehled o~pěněžních tocích (cashflow) nikoliv. Lze jej však z~uvedených výkazů spočítat pomocí tzv. cashflow analýzy. Dále bývá často do závěrek zahrnut také přehled o~změnách vlastního kapitálu.


\begin{figure}
  \centering
  \includegraphics[width=14cm]{img/vykazy.png}
  \caption{Výkazy učetní závěrky a jejich obsah \cite{komplex}}
\end{figure}

\subsubsection{Výkaz zisku a~ztráty}
Výkaz zisku a~ztráty, také výsledovka, ukazuje, jakého hospodářského výsledku bylo dosaženo v~daném účetním období. Data výsledovky jsou počítány z~dat výsledovkových účtů. Jednotlivé účty jsou kategorizovány podle jejich účelu a~položky výsledovky jsou sumy účtů odpovídající kategorie. Je to jakási agregace záznamů o~pěněžních tocích za celé účetní období, z~nichž každý je buď výnosem nebo nákladem (pozn. není to to samé jako příjmy a~výdaje). Výnosy i náklady jsou dále rozděleny na provozní a finanční činnost. Po sečtení výsledků za obě činnosti získáme pro mnohé nejdůležitější informaci o~hospodaření podniku -- výsledek hospodaření. Tím se rozumí buďto zisk (výnosy převyšují náklady) nebo ztráta (náklady převyšují výnosy). V~případě zisku je navíc subjekt ze zákona povinen odvést daň ze zisku, čímž teprve získáme hodnotu čistého zisku.

\subsubsection{Rozvaha}
Také označována termínem bilance. Na rozdíl od výkazu zisku a~ztráty jsou při sestavování rozvahy data vázána k~jednomu určitému okamžiku, takzvanému rozvahovému dni, který je posledním dnem účetního období, zpravidla posledním dnem kalendářního roku. Data mají tedy statickou povahu.

Hlavními složkami rozvahy jsou aktiva a~pasiva. Zatímco aktiva představují majetek společnosti (budovy, stroje, materiál, vozidla, \dots, ale i software nebo know-how), pasiva jsou zdrojem krytí těchto aktiv (kapitál). V~průběhu roku se hodnota aktiv a~pasiv liší právě o~hodnotu, o~kterou se liší náklady a~výnosy. Při sestavování závěrky se rozdíl nákladů a~výnosů po zdanění přenese na rozvahový účet (představující pasivum) s~názvem hospodářský výsledek ve schvalovacím řízení, čímž se aktiva a~pasiva vyrovnají. Část zisku musí být investována do fondů (ze zákona, případně stanov společnosti), valná hromada poté rozhodne, co se zbytkem. Může navýšit vlastní jmění podniku nebo zisk rozdělit mezi vlastní investory, což je znázorněno na obrázku \ref{ccf}. Hlavním rozdělením aktiv je na krátkodobá a~dlouhodobá, hlavním rozdělením pasiv je na vlastní a~cizí kapitál.




%-----
\section{Absolutní ukazatele}

\subsection{Horizontální analýza}
Při horizontální analýze je určitá položka (řádek) finančního výkazu porovnávána se stejnou položkou za jiné časové období. Při výpočtu tedy porovnáváme výsledky jedné položky napříč různými obdobími - proto horizontální analýza. U~jednotlivých položek zvlášť je vypočtena absolutní hodnota meziroční změny a~její procentuální vyjádření. Tento postup je proti ostatním velmi ilustrativní, působivý a~přímočarý. Této analýze můžeme podrobit výkaz zisku a ztrát, rozvahu i přehled peněžních toků.

Při posuzování výsledků by měl analytik zohlednit významné meziroční změny, které mají vliv na výsledek -- změny v~daňové soustavě, podmínek na trhu, změna politické situace, míra inflace a~podobně. Výsledek je běžně interpretován pomocí sloupcového nebo spojnicového grafu.


\subsection{Vertikální analýza}
Přívlastek vertikální vychází tak jako u~horizontální analýzy ze způsobu zpracování finančních výkazů (opět výkazu zisku a ztrát, rozvahy i přehledu finančních toků). Dáváme tak do poměru jednotlivé položky výkazů. Na rozdíl od poměrových ukazatelů zmíněných dále se však při vertikální analýze dává do poměru část celku k~celku samotnému. Dalo by se tedy říct, že vyčíslováním podílu vybrané části na celku vertikální analýza popisuje strukturální rozložení sledované entity (například aktiv nebo pasiv či jejich složek). 

Výhodou vertikální analýzy je, že není ovlivněna meziroční inflací a~výsledky se tak dají provnávat s~výsledky za jiné časové období, mimo to i s~výsledky jiných podniků.\cite{sedl}






%-----
\section{Poměrové ukazatele}
Výpočet je opět založen na datech z~rozvahy a~výsledovky, existují ale i poměrové ukazatele založené na cashflow. Na rozdíl od horizontální a~vertikální analýzy, při kterých je sledován vývoj jedné veličiny v~čase případně vývoj ve vztahu k~určité vztažné veličině (nadřazenému celku), při výpočtu poměrových ukazatelů zkoumáme vztah mezi jednotlivými veličinami navzájem, čímž získáváme zase jinou vypovídací hodnotu.

Existuje několik různých ukazatelů. Různé ukazatele slouží různým účelům, různé společnosti se řídí různými ukazateli. Podle účelu a~povahy ukazatele ho lze zařadit do některé ze skupin soustavy ukazatelů. V~této práci budou zmíněny základní skupiny poměrových ukazatelů -- rentability, likvidity, aktivity a~zadluženosti, v~rámci nichž budou popsány i jednotlivé ukazatele.

Jak plyne z~názvu, při výpočtu hodnoty ukazatele se obecně používá nějakého poměru, tedy zlomku. Možností, které hodnoty dát do poměru, je takřka neomezeně. Nicméně při konstrukci jednotlivých ukazatelů bychom se měli zamyslet nad tím, co při vybraných entitách vlastně vztah vyčísluje -- zda má konkrétní volba význam pro účel analýzy.\cite{kisling}

%-----
\subsection{Ukazatele rentability}
\textit{profitability ratios}

Ukazatele rentability (výnosnosti, ziskovosti, návratnosti) patří v~praxi mezi nejsledovanější ukazatele. Vyjadřují míru efektivity hospodaření podniku poměřením výsledku hospodaření se zdroji, které byly na hospodaření vynaloženy.

$$\zl{výsledek hospodaření}{zdroje}$$

Ukazatele rentability jsou mezivýkazovými ukazateli, což znamená, že jsou při jejich výpočtu použity hodnoty z~výsledovky i rozvahy. Jednotlivé ukazatele rentability se liší především tím, co je chápáno pod pojmem zdroje ve jmenovateli.\cite{mendelu} Podle volby jmenovatele je vytvořeno také následující rozdělení ukazatelů rentability. 

V~rámci jednoho ukazatele však existuje několik dalších variant výpočtu. Ty se vzájemně liší složkou v~čitateli, která zachycuje výsledek hospodaření (zisk) v~rozdílných fazích -- před nebo po zdanění, odečtení úroků, provedení odpisů a~amortizace. Do čitatele může být dosazen i jiný ukazatel firemní výkonosti, jako například provozní cashflow. Volíme takové hodnoty, které mají pro danou situaci největší vypovídací hodnotu.

\begin{itemize}
\item EAT -- earnings after taxes, čistý zisk -- zisk po zdanění, zúročení, odpisech a~amortizaci

\item EBT -- earnings before taxes, hrubý zisk -- zisk před zdaněním, t.j. po odečtení úroků, odpisech a~amortizaci

\item EBIT -- earnings before interest and taxes, provozní zisk -- zisk před zdaněním a~zúročením. Uzití této hodnoty je vhodné například při srovnávání dvou podniků s~různou výší daně z~příjmu a~různou kapitálovou strukturou

\item EBITDA -- earnings before interest, taxes, depreciation and amortization -- zisk před zdaněním, úroky, odpisy a~amortizací

\item NOPAT = EBIT$*(1-t)$, kde $t$ je sazba daně z~příjmů  -- zdaněný (čistý) zisk bez odečtení úroků, t.j. kolik by dělal čistý zisk, kdyby podnik nemusel platit úroky (kdyby nečerpal žádný úvěr)
\end{itemize}


\begin{figure}
  \centering
  \includegraphics[width=10cm]{img/zisk.png}
  \caption{Grafická intepretace jednotlivých druhů zisku}
\end{figure}

%-----
\subsubsection{Rentabilita aktiv}
\textit{return on assets, ROA}

ROA je ukazatel, který do jmenovatele dosazuje celkový objem aktiv (potažmo pasiv, jelikož jsou jimi kryta). Při výpočtu se tedy nebere ohled na to, zda jsou aktiva vlastní nebo cizí, dlouhodobá nebo krátkodobá. Tím vyjadřuje, jak efektivně dokáže podnik naložit s~aktivy, které se do něj vloží (odtud zřejmě plyne označení produkční síla nebo výkonnost podniku).

Nejčastějšími variantami uváděnými v~literatuře jsou ty, které mají v~čitateli hodnotu EBIT, tedy zisk před odečtením nákladových úroků (rentabilita celkových aktiv by neměla brát v~potaz původ zdrojů) a~zdaněním. Tato volba nám zároveň umožňuje porovnat podniky s~rozdílnými zdroji financování a~různým daňovým zatížením.

$$\vz{ROA}{EBIT}{celková aktiva} \scite{sedl}$$

Další používanou variantou je s~hodnotou NOPAT v~čitateli. Výsledkem je rentabilita, která by plynula z~čistého zisku, pokud by byly veškeré zdroje financování vlastní. Dochází zde k~fiktivnímu zdanění úroků, jelikož EBIT$*(1-t)$ se dá zapsat také jako EAT$+$Ú$*(1-t)$.

$$\vz{rentabilita aktiv}{EBIT $*(1-t)$}{celková aktiva} \scite{sedl}$$ 


%-----
\subsubsection{Rentabilita vlastního kapitálu}
\textit{return on equity, ROE}

ROE do jmenovatelele dosazuje hodnotu vlastního kapitálu, čímž vyjadřuje míru jeho zhodncení. Jinými slovy udává, kolik korun zisku připadá na 1 korunu vlastního kapitálu. Pro vlastníky (akcionáře, společníky a~další investory) podniku je jedním z~klíčových ukazatelů, neboť pomocí něj mohou zjistit, zda jimi vložený kapitál přináší výnos odpovídající velikosti jejich investičního rizika.\cite{sedl}

Investor by se měl také zajímat, zda je procentuální hodnota ROE vyšší než bezriziková úroková míra (úroková sazba státních dluhopisů), v~praxi spíše vyšší než nejvyšší úroková sazba nabízená bankami. Pokud by byla nižší, obnos investovaný do podniku by mohl raději vložit do banky a~téměř bez námahy a~bez rizika dosáhnout většího výnosu.

Výpočet má pochopitelně smysl zejména s~čistým ziskem (EAT) v~čitateli, avšak ve jmenovateli můžeme uvažovat nad odečtením fondů, ze kterých investor ve výsledku těžit nebude.

$$\vz{rentabilita vl. kapitálu}{EAT}{vlastní kapitál} \scite{sedl}$$ 


%-----
\subsubsection{Rentabilita tržeb}
\textit{return on sales, ROS}

V~praxi velmi často používaný ukazatel. Poměřuje zisk podniku a~tržby (tržby za prodej zboží, výrobků a~provedení výkonů), tedy kolik procent tržeb tvoří zisk.

Pokud by byla výsledkem relativně malá, dlouhodobě klesající hodnota (např. 2\%), je vhodné zpozornit. Pokud by došlo k~náhlému poklesu tržeb při zachování nákladů (což je běžné), je zřejmé, že se podnik dostane do finančních potíží. Stejnětak se může dostat do potíží při zvýšení nákladů (zdražení materiálu, energií, pracovní síly) se současným zachováním objemu tržeb (zvýšení nákladů se však na tržby zpravidla promítne). 
V~čitateli se nejčastěji používá hodnota EBIT nebo EAT

$$\vz{rentabilita tržeb}{EBIT (nebo EAT)}{tržby} \scite{sedl}$$ 

%-----
\pagebreak
\subsubsection{Rentabilita investice}
\textit{return on investment, ROI}

Další z~často používaných ukazatelů. Jak napovídá název, ukazatel vyjadřuje rentabilitu spíše z~pohledu konkrétního investičního projektu, z~výše sumy investic provedených během vymezeného období, nežli z~celopodnikového pohledu. Oba přístupy by pojednávaly o~tom samém v~případě, že by se jednalo o~investici do koupi podniku. Rentabilita této investice by pak byla stejná jako rentabilita vlastního kapitálu, v~případě nezadluženého podniku i stejná jako rentabilita celého podniku.

$$\vz{rentabilita investice}{výnos investice}{náklady na investici} \scite{sedl} $$ 

%-----
\subsubsection{Některé další ukazatele rentability:}
\begin{itemize}
\item{ROC -- rentabilita nákladů} -- return on costs
\item{ROCE -- rentabilita dlouhodobě investovaného kapitálu} -- return on capital employed
\end{itemize}







%-----
\subsection{Ukazatele likvidity}
\textit{luqiudity ratios}
Pojem likvidita bývá nesprávně zaměňován s~úzce souvisejícími pojmy likvidnost a~solventnost. Likvidnost je vlastnost jednotlivých složek aktiv podniku vyjadřující schopnost přeměny těchto složek v~peněžní prostředky v~co nejkratším čase a~s~minimálními ztrátami.\cite{nyvlt} Přeměnou můžeme rozumět například prodej zásob nebo inkasování pohledávek. 

Solventnost neboli platební schopnost je definována jako schopnost subjektu, v~našem případě podniku, včas splácet své finanční závazky. Má-li být podnik solventní, musí kromě stálého generování zisku také zajistit, aby byla část aktiv vázána ve formě, kterou může uhradit své závazky.

Likvidita podniku dává tyto pojmy do souvislosti -- ukazatele likvidity vyjadřují schopnost podniku přeměnit vybraná aktiva na peněžní prostředky (využít jejich likvidnosti) za účelem včasného uhrazení všech splatných závazků (a tím pádem být dočasně solventní).\cite{schol} Proto bývají také označovány jako ukazatele platební schopnosti.

Všechny ukazatele likvidity se počítají jako poměr toho, čím je možné platit (disponibilní prostředky), k~tomu, co se musí zaplatit. Disponibilními prostředky můžeme přitom chápat různou množinu aktiv. Je samozřejmě nesmysl, aby byla zahrnuta ta aktiva, jejichž ztráta by ohrozila chod podniku.

%-----
\subsubsection{Běžná likvidita (likvidita III. stupně)} 
\textit{current ratio, CR}

Poměr ukazuje, kolikrát pokrývají oběžná aktiva krátkodobé závazky, jinými slovy, kolikrát je podnik schopen uhradit své krátkodobé závazky z~peněžních prostředků, které by získal přeměnou z~oběžných aktiv.

Uváděná optimální hodnota se v~literaturách různí, zřejmě se bude lišit i v~závisloti na typu podniku. Hodnota ukazatele by určitě neměla být menší než 1, což by znamenalo nutnost financovat závazky z~dlouhodobých zdrojů financování a~jinými nevhodnými způsoby. Také berme v~potaz, že po pokrytí závazků by měly zbýt prostředky pro další činnost podniku.
Optimální hodnota uvedená v~preferovaném zdroji je CR$\geq 1.5$, ale obecně lze tvrdit, že čím stabilnější jsou příjmy a~čím jistější jsou zdroje těchto příjmů, tím více se může hodnota běžné likvidity blížit jedné.\cite{businessvize_bez_likv}

$$\vz{běžná likvidita}{oběžná aktiva}{krátkodobé závazky} \scite{sedl}$$

%-----
\subsubsection{Pohotová likvidita (likvidita II. stupně)} 
\textit{quick asset ratio, QAR}

Pokud bychom zkoumali strukturu oběžných aktiv, zjistili bychom, že se likvidnost jednotlivých složek liší. Výpočet běžné likvidity zahrnuje i zásoby, nicméně ty při výpočtu pohotové likvidity nejsou zahrnuty, jelikož většinou bývají nezbytné pro zachování chodu podniku a~navíc jejich likvidnost nemusí být dostačující.
V~čitateli tak zbude součet objemu peněžních prostředků, ekvivalentů a~pohledávek. Pro zpřesnění výsledku je vhodné odečíst nedobytné pohledávky.
Dá se předpokládat, že podniky z~oblasti služeb nebudou mít v~zásobách mnoho aktiv a~proto se bude hodnota ukazatele blížit hodnotě běžné likvidity. U~výrobních podniků se naopak tyto dvě hodnoty budou spíše lišit.

$$\vz{pohotová likvidita}{oběžná aktiva $-$ zásoby}{krátkodobé závazky} \scite{sedl}$$

%-----
\subsubsection{Hotovostní likvidita (likvidita I. stupně)}
\textit{cash position ratio, CPR}

Při výpočtu hotovostní likvidity dosazujeme do čitatele součet jen těch nejlikvidnější složek oběžných aktiv, kterými jsou pěněžní prostředky (peníze v~hotovosti a~na běžných účtech) a~jejich ekvivalenty (například šeky nebo obchdovatlné cenné papíry).
Přestože tento ukazatel nejlépe vypovídá o~platební schopnosti podniku k~určitému datu, nebere v~potaz strkuturu krátkodobých závazků, především z~pohledu jejich skutečné splatnosti.\cite{mendelu} Pokud bychom chtěli tuto skutečnost zohlednit, měli bychom do jmenovatele zahrnout pouze okamžitě splatné závazky. Taková varianta bývá označována jako okamžitá likvidita.


$$\vz{hotovostní likvidita}{peněžní prostředky $+$ ekvivalenty}{krátkodobé závazky} \scite{sedl}$$








%-----
\subsection{Ukazatele aktivity}
\textit{activity ratios}

Další z~mezivýkazových ukazatelů -- vstupními daty jsou položky jak z~výkazu zisku a~ztrát tak z~rozvahy. Ukazatele aktivity vyjadřují, jak efektivně podnik nakládá se svými aktivy. Pokud jich vlastní více, než je nutné, vznikají zbytečné náklady a~dochází ke snižení zisku. Jestliže jich má nedostatek, přichází o~výnosy z~potenciálních zakázek, o~které se kvůli nedostatku aktiv nemůže ucházet.

Výsledkem je hodnota udávající rychlost nebo dobu obratu. Rychlost obratu vyjadřuje, kolikrát se určitá složka aktiv přemění za sledované období na peněžní prostředky. Doba obratu nám říká, jak dlouho trvá přeměna.

Pokud známe hodnotu rychlosti obratu sledovaných aktiv X, dobu obratu X (výsledkem budou dny) vypočítáme jednoduše jako 

$$\vz{doba obratu \textit{X}}{365}{rychlost obratu \textit{X}}$$


%-----
\subsubsection{Obrat celkových aktiv}
\textit{total assets turnover}

Udává, kolikrát se obrátí celková aktiva za sledované časové období. Nevýhodou tohoto a~některých dalších ukazatelů je povaha vstupních veličin: tržby jsou zachyceny jejich sumou za celé období, kdežto hodnota aktiv se vztahuje ke konkrétnímu časovému okamžiku, kdy byla rozvaha vytvořena. Přesnějšího výsledku by se dalo dosáhnout použitím průměrné hodnoty sledovaných aktiv. 

$$\vz{obrat celkových aktiv}{tržby}{celková aktiva} \scite{mendelu}$$

%-----
\subsubsection{Obrat stálých aktiv}
\textit{fixed assets turnover}

Stálá aktiva jsou taková, která slouží podniku déle než jeden rok a~jsou spotřebovávána postupně, nikoliv jednorázově. Konkrétně je to součet dlouhodobého hmotného, nehmotného a~finančního majetku, t.j. například budovy, pozemky, vozidla, stroje, software, know-how a~mnoho dalších.

Ukazatel potom vyjadřuje míru využití těchto aktiv. Pokud při analýze vyjde hodnota nižší, než je průměr v~odvětví, může to znamenat nedostatečné využití stávajících fixních (dlouhodobých) aktiv a~manažeři by tak měli zvážit, jak jejich využití zefektivnit namísto investování do aktiv nových.

$$\vz{obrat stálých aktiv}{tržby}{dlouhodobý majetek} \scite{mendelu}$$

%-----
\subsubsection{Obrat zásob}
\textit{inventory turnover}

Říká, kolikrát je za sledované období položka zásob prodána a~opět naskladněna.

Při použití tohoto ukazatele je nutné si uvědomit, že tržby vyjadřují tržní hodnotu (za kolik se prodalo), kdežto hodnota zásob bývá vyjádřena jejich pořizovací cenou (za kolik se nakoupilo). Přesnějšího výsledku obratovosti může být dosaženo umístěním nákladů na prodané zboží do čitatele namísto tržeb.

Ukazatel pro zásoby výrobků nebo zboží je rovněž ukazatelem likvidnosti těchto zásob (udává, jak dlouho trvá přeměna zásob na finanční prostředky).

$$\vz{obrat zásob}{tržby}{zásoby} \scite{mendelu}$$


%-----
\subsubsection{Doba obratu pohledávek}
V~tomto případě je směrodatnější spíše doba trvání pohledávky než počet obratů pohledávek. Doba se vypočítá jako poměr průměrného stavu pohledávek k~průměrné denní tržbě na obchodní úvěr (fakturu, \uv{sekeru}).

Hodnota ukazatele dlouhodobě vyšší než hodnota stanovená platebními podmínkami pro klienta může znamenat problémové portfolio odběratelů, kteří nejsou schopni plnit své závazky včas.

$$\vz{doba obratu pohledávek}{prům. stav pohledávek}{prům. denní tržby} \scite{mendelu}$$

\subsubsection{Doba obratu závazků}
Průměrná doba odkladu plnění závazků. Nabízí se porovnání s~dobou obratu pohledávky. 





%-----
\subsection{Ukazatele zadluženosti}
\textit{debt ratios}

Zadluženost podniku souvísí s~velikostí podílu cizích zdrojů na všech zdrojích financování podniku, jelikož cizí zdroje pro podnik zpravidla znamenají dluh, závazek. Měří tedy dopady financování cizími zdroji. Využití cizích zdrojů se vyplácí, dokud zajistí výnos vyšší, než jsou náklady na tyto zdroje -- úroky.

V~praxi se běžně nesetkáme s~většími podniky, které by byly financovány výhradně z~vlastních nebo výhradně z~cizích zdrojů, jsou tedy do jisté míry zadluženy. Zadluženost obecně není negativní charakteristikou -- využití cizích zdrojů vede k~zesílení tzv. finančního pákového efektu, který pozitivně přispívá k~rentabilitě vlastního kapitálu.\cite{kisling} S~rostoucím procentem vyjadřujícím zadluženost však roste i riziko věřitelů. Čím vyšší bude riziko věřitelů, tím obtížněji bude podnik další cizí zdroje získávat a~tím nevýhodnější budou podmínky jeho poskytnutí.\cite{mendelu} Jedním z~důležitých cílů finanční analýzy je nalezení ideální míry zadluženosti respektive ideálního rozložení finanční struktury. Vzhledem k~poměrně rozšířenému leasingovému financování zmíním, že by bylo vhodné takto pořízený majetek zohlednit a~přičíst k~cizímu kapitálu, má-li významnější objem.

\begin{figure}
  \centering
  \includegraphics[width=15cm]{img/tab.png}
  \caption{Srovnání výnosnosti při různém poměru vlastního a~cízího kapitálu}
\end{figure}

% \begin{figure}
%   \centering
%   \begin{tabular}{ C{11mm}  C{13mm}  C{12mm}  C{11mm}  C{11mm}  C{18mm}  C{11mm}  C{11mm}  C{12mm} }
%     \hline
%     Firma & Vlastní kapitál & Cizí kapitál & ROA (20\%) & Úroky (8\%) & Zisk nezdaněný & Daň (40\%) & Zisk čistý & ROE \\ 
%     \hline
%     A & 2000 & -- & 400 & 0 & 400 & 160 & 240 & 12\% \\
%     B & 1000 & 1000 & 400 & 80 & 320 & 128 & 192 & 19,20\% \\
%     \hline
%   \end{tabular}
%   \caption{Srovnání výnosnosti při různém poměru vlastního a~cízího kapitálu}
% \end{figure}


%-----
\subsubsection{Celková zadluženost}
\textit{debt ratio, DR}

Základním ukazatelem zadluženosti je celková zadluženost jako podíl cizího kapitálu na celkových aktivech. S~rostoucí hodnotou tohoto ukazatele roste i riziko věřitelů a~cena za cizí kapitál (výše úroků). Věřitelé preferují nižší hodnoty -- v~případě likvidace podniku mohou být pohledávky (nejen) věřitelů uhrazeny z~vlastního kapitálu podniku (takzvaný finanční polštář).
Z~hlediska vlastníků akcií jsou vysoké hodnoty ukazatele příznivé, dokud podnik dosahuje vyššího procenta rentability než je procento úroku na cizí kapitál, což znamená, že výsledné zhodnocení kapitálu je vyšší než jeho pořizovací cena.\cite{such}

$$\vz{celková zadluženost}{cizí kapitál}{celková aktiva} \scite{sedl}$$

\vspace{3mm}
Doplňkovým ukazatelem k~celkové zadluženosti je ukazatel poměru vlastního kapitálu (\textit{equity ratio, ER}). Jejich součet by měl být DR$+$ER$
\doteq 1$

$$\vz{poměr vlastního kapitálu}{vlastní kapitál}{celková aktiva} \scite{sedl}$$

%-----
\subsubsection{Koeficient (míra) zadluženosti}
\textit{debt to equity ratio, D/E}

Dá se spočítat jako poměr hodnoty cízího kapitálu k~hodnotě vlastního. Stejný výsledek bychom získali poměrem předchozích dvou ukazatelů. V~případě, že podnik využívá ve větším objemu leasingového financování, je vhodné tuto skutečnost zohlednit přičtením objemu k~cizímu kapitálu. 

$$\vz{koeficient zadluženosti}{cizí kapitál}{vlastní kapitál} \scite{sedl}$$

\vspace{3mm}
Ve finanční analýze se používá i převrácená hodnota ukazatele, která by se dala nazvat jako míra finanční samostatnosti podniku.

%-----
\subsubsection{Úrokové krytí}
\textit{interest coverage, IC}

Ukazatel vyjadřuje, kolikrát podnik pokryje úroky plynoucí ze závazků věřitelům poté, co uhradí všechny náklady na provoz (tzn. z~provozního zisku). Dá se tedy chápat jako dopad zadlužení na zisk. Obecně platí, že čím vyšší je jeho hodnota, tím lépe pro podnik. Pokud by byla hodnota IC$<1$, znamená to, že podnik hospodaří se ztrátou (není schopen ani pokrýt úroky). Pokud by vyšla hodnota ukazatele IC$=1$, znamená to, že se veškerý zisk použije k~uhrazení úroků za vypůjčený kapitál a~k~vyplacení vlastních investorů nebo k~reinvestici do kapitálu nezbudou žádné prostředky.

$$\vz{úrokové krytí}{EBIT}{nákladové úroky} \scite{sedl}$$








\section{Ostatní}

\subsection{Analýza peněžních toků}
Rozvaha zachycuje stav majetku a jeho krytí (kapitálu) ve chvíli jejího vytváření. Výkaz zisku a ztráty zase zaznamenává různé kategorie výnosů a nákladů a z~nich plynoucího zisku či ztráty za určité období, nehledě na to, zda se jedná o~reálné peněžní příjmy či výdaje. Proto se neshodují výnosy s~příjmy, náklady s~výdaji a zisk či ztráta se změnou stavu peněžních prostředků. Pro tento účel slouží analýza peněžních toků, jejíž podstatou je sledování změn stavu peněžních prostředků.\cite{komplex} Z~toho lze vyvodit, ze úzce souvisí s~řízením likvidity podniku.



Přehled peněžních toků jsme schopni vytvořit z~výkazu zisku a ztrát a rozvahy. Peněžní toky lze rozdělit do celkem tří kategorií podle druhu činnosti podniku, pod které spadají. Jsou to:

\begin{itemize}
  \item provozní činnost -- provozní činnost podniku bez vlivu nepeněžních a mimořádných operací, obecně peněžní operace, které nelze zařadit do investiční činnosti či financování podniku
  \item investiční činnost -- poskytuje přehled o~pohybu peněžních prostředků v~souvislosti s~dlouhodobými aktivy a také dalšími skupinami, které hrají významnou roli při vytváření zisků v~budoucnu
  \item financování podniku -- pohyby peněžních prostředků ovlivňující strukturu a velikost vlastního či cizího jmění podniku
\end{itemize}



\subsection{Du Pont rozklad}
Tato analýza se řadí mezi pyramidové soustavy ukazatelů. Zatímco výsledky všech předchozích analýz byla většinou konkrétní čísla, pyramidové soustavy ukazatelů nám davají tato čísla do souvislostí odpovídajících realitě. Namísto čísla zachycujícího jediný rys složitého procesu zachycuje tato analýza všechny závislosti a vztahy uvnitř procesu. Jedná se o~rekurzivní rozklad výpočtu finančního ukazatele na podsložky, což nám umožňuje sledovat faktory ovlivňující výsledek na všech úrovních, nebo naopak zjistit, na které podsložky se zaměřit pri snaze o~dosažení změny na vyšší úrovni. Zápis rozkladu může být samozřejmě vyjádřen matematicky, velmi vhodná je i jeho grafická reprezentace.

V~případě analýzy Du Pont se provádí rozklad ukazatele rentability vlastního kapitálu (ROE). Schéma rozkladu je vidět na obrázku \ref{dupont}. Na nejnižší úrovni se na levé straně objevuje rentabilita tržeb, označována také jako zisková marže, která udává podíl čistého zisku na tržbách (zohlednění nákladů). Pokud tržby rostou a zisková marže klesá, je vhodné provést analýzu nákladů. Složky na pravé straně poté tuto marži dávají do souvislosti s~majetkem firmy. Vynásobením obratovostí aktiv získáme jejich rentabilitu, následným zohledněním struktury kapitálu získáme rentabilitu vlastního kapitálu.

\begin{figure}
  \centering
  \includegraphics[width=11cm]{img/dupont.png}
  \caption{Rozklad Du Pont \cite{ruck} (FP -- finanční páka, OA -- obrat aktiv)}
  \label{dupont}
\end{figure}

\subsection{Vnitřní výnosové procento}
\label{vvp}
internal rate of return

Vnitřní výnosové procento vyjadřuje míru výnosnosti investice, tedy ROI, se současným zohledněním proměnné hodnoty peněz v~čase (diskontace). Ve světě patří spolu s~NPV (net present value, čistá současná hodnota) mezi nejpoužívanější ukazatele pro zhodnocení a~výběr investice. Podle průzkumu VŠE je v~ČR preferován spíše ukazatel doby návratnosti investice.\cite{businessvize_irr}

NPV slouží k~přiblížení, kolik peněz nám projekt, jehož investování zvažujeme, za sledované období přinese nebo sebere. Nebere přitom nijak v~úvahu výnosy a~náklady nebo hodnotu společnosti, proto je nevhodný pro strategické projekty. Nevýhodou NPV a~tím pádem i IRR je nutnost odhadu nejen budoucích finančních toků, které sledovaný projekt přinese, ale také výše diskontu. Odhad hodnoty lze zpřesnit různými technikami (viz doporučená literatura). Důležitá je také odhadovaná doba životnosti projektu, přidáním nebo odebráním jednoho období se může změnit ztráta na zisk i opačně.

Nejprve si uvedeme vzorec pro výpočet čisté současné hodnoty: 
\\($r=$diskont, $t=$pořadí období, $CF_t$=suma toků v~období, $IN=$vstupní investice)
$$NPV=\sum\limits_{t=0}^{n} \dfrac{CF_t}{(1+r)^t} = \sum\limits_{t=1}^{n} \dfrac{CF_t}{(1+r)^t} - IN\scite{businessvize_irr}$$

Matematicky lze IRR vyjádřit hodnotou diskontní sazby, při které je čistá současná hodnota (NPV) rovna nule. Dostáváme tedy následující vzorec:
$$\sum\limits_{t=1}^{n} \dfrac{CF_t}{(1+IRR)^t} - IN = 0 \scite{businessvize_irr}$$

Z~uvedeného vzorce lze usoudit, že nalezení hodnoty analytickým řešením není triviální. Rovnice se řeší numericky, iterativními výpočty.








































\chapter{Návrh řešení}
V~této kapitole bude popsán návrh vlastního řešení. Nejprve budou zmíněny a otestovány podobné, již existující nástroje. Poté bude vypracován návrh -- vymezíme požadovanou funkcionalitu nástroje a nastíníme možné technické řešení. Budou zde popsány i technologie zahrnuté do návrhu technického řešení.



\section{Existující software}
Před návrhem řešení bylo vhodné prozkoumat existující řešení. Plné verze nástrojů pro tyto účely bývají zpoplatněny, závěry jsou tedy vyvozeny ze zkušebních verzí, pochopitelně s~omezenou funkcionalitou, případně z~náhledů a~uživatelských dokumentací software.

Všechny testované nástroje jsou ve formě desktopových aplikací určených pouze pro platformu Windows. Po rozpravě s~osobou z~praxe bylo zjištěno, že je velmi často k~účelům analýzy používán program Excel. Příčinou je nejspíš široká základna uživatelů, kteří v~jeho prostředí zvládají alespoň základní úkony s~daty a také široké spektrum funkcionality, které zahrnuje i výpočty z~oblasti finanční analýzy. Velmi často jsou v~souborech určených pro tento program také uchovávána vstupní data analýzy.

\subsubsection{FAF -- Finanční analýza firmy}
Software nelze bez zakoupení jakkoliv používat, nicméně na webových stránkách je dostupné instruktážní video a~uživtelská přiručka popisující jak nástroj vypadá, jak se s~ním pracuje a~co všechno dokáže. Uživatelské rozhraní vypadá na první pohled zastarale, to ale nijak neubírá na přehlednosti.

Uživatelské rozhraní kromě grafů využívá také stupnic, na které umisťuje ukazatele. Je zde obrazovka \uv{rating}, což jsou různé ukazatele, každý z~ukazatelů je zobrazen za různá časová období a~v~konkrétním časové období na stupnici od 1 do 10. Všechny ukazatele pohromadě lze zobrazit v~tabulce pro jedno časové období.

Ukazatele jsou i na obrazovce s~trendy, ta mimo ukazatele obsahuje i trendy položek výkazu zisku a~ztráty a~rozvahy. Je zde také zobrazen seznam rizikových faktorů. Ty se od ukazatelů liší tím, že jsou buďto v~pořádku nebo ne, nic mezi tím (např. skutečnost, že podnik hospodaří se ztrátou).

Nástroj dále umožňuje vertikální analýzu, horizontální analýzu, analýzu cash flow a~výpočet hodnoty firmy.

Funkcionalita, která mě nejvíce zaujala, je nazvaná \uv{co když}. Spočívá v~umožnění uživateli jednoduše manipulovat se vstupními daty analýzy a~zároveň sledovat, jaký dopad by se měla tato změna na hodnotu ukazatelů.

Hodnoty z~ výkazu zisku a~ztráty a~rozvahy jsou zadávány do tabulky. Instruktážní video ani uživatelská příručka nehovoří o~tom, zda nástroj podporuje automatizované načítání výstupních dat z~některých jiných nástrojů z~oblasti financí (např. účetních).

Dalším nedostatkem byla sekce s~vysvětlením pojmů. Všechny pojmy jsou na jedné hromadě, na konkrétní pojem se nelze prokliknout.


\subsubsection{Equanta}
Zatímco FAF je pravděpodobně výtvorem jednoho nebo malé skupiny vývojářů a~jsou v~něm obsaženy pouze klíčové metody a~ukazatele finanční analýzy (které ale ve většině případů stačí), Equanta je mnohem sofistikovanějším nástrojem, za jehož vývojem nejspíš stojí větší počet vývojářů -- společnost ATLAS consulting s.r.o. . Ta má ve svém portfoliu i jiné, nejen finančně zaměřené nástroje.

Equanta má o~poznání modernější rozhraní, obsahuje i více sekcí, ukazatelů a~pohledů na hospodaření podniku. Obsahuje také automatizované načítání vstupu, a~to nejen z~ výkazu zisku a~ztráty a~rozvahy ve formátu pro finanční úřad, ale i z~účetních dat nástrojů jako je Pohoda. V~nástroji je možné provádět mezipodnikové srovnání úzávěrek a~ukazatelů, které se v~praxi používá relativně často.

Nástroj si pamatuje naposledy ovtevřené dokumenty, tyto dokumenty lze seskupovat pod projekty, jsou zde zpřístupněna různá nastavení a~další možnosti personalizace, což implikuje využití persisentních dat. To je proti nástroji FAF další velkou výhodou. 


\subsubsection{FinAnalysis}
Nástroj je realizován jako přednastavená šablona v~tabulkovém prostředí MS Excel. Toto řešení může být rýchlé a~efektivní, nicméně pro naše účely naprosto nevyhovující, jelikož je jeho používání podmíněno používáním MS Excel. Nástroj je prostředím svého běhu omezen, veškerá rozšíření je nutné implementovat funkcemi Excelu.

Přesto nástroj plní svůj ůčel a~lze se v~něm inspirovat možnostmi provádení základních analýz, výpočty mnoha ukazatelů a~interpretací výsledků. Jednotlivé sekce jsou realizovány jako listy v~Excelu. První tři listy (list s~vúkazem zisku a~ztáty, rozvahou a~list se základními údaji jako například počet zaměstnanců) slouží k~zadávání dat. Zbývající listy obsahují výsledky, jsou pouze pro čtení a~odpovídají rozdělení podle jednotlivých typů analýzy. Jak již bylo zmíněno, použití programu Excel je v~oblasti financí velmi časté.



%-----
\section{Vybrané metody vyhodnocování}
Nástroj by měl být schopen provádět analýzu alespoň v~rozsahu teoretické části této práce. Pro hodnocení podniku jsou to horizontální a vertikální analýza, analýza poměrových ukazatelů, cashflow a Du Pont rozklad. Hodnoceny budou také investice, u~kterých bude počítáno vnitřní výnosové procento a čistá současná hodnota. Podoba výstupu se mění v~závislosti na vybrané analýze nebo ukazateli. Výstupem může být finanční částka, absolutní nebo relativní hodnota, procentuální podíl, tabulka s~těmito hodnotami v~čase, graf s~vývojem hodnot v~čase.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=14cm]{img/ucd.png}
  \caption{Use case diagram navrhované aplikace}
\end{figure}


\subsubsection{Vertikální a~horizontální analýza}
Hned jako první se nabízí porovnání s~hodnotami za předchozí období, tedy horizontální analýza. Při horizontální analýze jedné položky výkazu zisku a~ztráty nebo rozvahy se nejčastěji používá sloupcového (v~případě více sledovaných období spojnicového) grafu. Nástroj bude umožňovat i hromadnou horizontální analýzu -- výsledek bude interpretován tabulkou; meziroční změna u~jednotlivých položek bude vyjádřena absolutní i procentuální hodnotou.

Podobně i pro vertikální analýzu. Pokud bychom chtěli analyzovat pouze užší část výkazu zisku a~ztráty nebo rozvahy, můžeme výsledky interpretovat v~grafech. Výsledky hromadné analýzy budou zobrazeny v~tabulce s~vyjádřením změn absolutní i procentuální hodnotou.

\subsubsection{Poměrové ukazatele}
Možnosti zobrazení poměrových ukazatelů budou podobné jako v~testovaných nástrojích.

Pro interpretaci hodnot poměrových ukazatelů budou využity:
\begin{itemize}
	\item stupnice
	\item tabulka s~přehledem hodnot ukazatelů
	\item tabulky s~trendy
	\item grafy (sloupcové, spojnicové, koláčové a~další)
\end{itemize}

Hodnoty ukazatelů půjde porovnat meziročně i mezipodnikově. Velmi vhodné by bylo také zhodnocení výstupních hodnot. V~literatuře lze pro některé ukazatele nalézt referenční hodnoty, pro jiné nikoliv. Hodnoty se však v~různých zdrojích liší, z~principu je nelze jednoznačně stanovit. Nabízí se zobrazení a porovnání s~průměrnými hodnotami v~odvětví, které jsou počítány kvartálně MPO\footnote{Ministerstvo průmyslu a obchodu České republiky} v~rámci finanční analýzy podnikové sféry\footnote{\url{https://www.mpo.cz/cz/rozcestnik/analyticke-materialy-a-statistiky/analyticke-materialy/}}. Tato možnost bude při dalším postupu prozkoumána a zvážena.


\subsubsection{Hodnocení investic}
Kromě analýzy podniku bude nástroj schopen analyzovat i investice, konkrétně bude možné volit mezi výpočtem vnitřního výnosového procenta investice nebo čisté současné hodnoty při zvolené úrokové sazbě. Vzhledem k~rovnicím v~sekci \ref{vvp} můžeme usoudit, že kromě úrokové sazby bude pro oba výpočty nutné zadávat také délku trvání investice, počáteční finanční výdaj a peněžní toky za jednotlivá období. Výpočet ČSH je přímočarý, pro výpočet VVP bude využita některá z~iterativních metod. Jako nejjednodušší a nejintuitivnější metoda se mi jeví metoda půlení intervalů. Pokud bude při implementaci zjištěno, že je tato metoda nevyhovující, můžeme použít jinou, například Newtonovu metodu.


%-----
\section{Návrh programového řešení}

Nástoroj nebude sloužit vyloženě jen pro dávkové zpracování dat. Půjde o~systém pro podnikatele, manažery a~analytiky, ve kterém bude možné pod určitým uživatelským účtem evidovat informace o~hospodaření různých podniků za různá časová období. Nástroj bude schopen načtená data uložit a~svázat s~daným uživatelským účtem, což umožní nejen jednoduchý přístup k~těmto datům a~jejich kvantitativní analýze, ale i jednoduchou správu dat pro meziroční a~mezipodnikové srovnání. Díky webovému rozhraní, což činí tento nástroj v~oboru jedinečným, bude možné přistupovat k~systému a~využívat jeho služeb kdykoliv a~odkudkoliv.

\subsection{Zadávání vstupních dat}
Vstupem kvantitativní finanční analýzy jsou data z~dokumentů výkaz zisku a~ztráty a~rozvaha. Při hledání vhodného způsobu automatizace načítání vstupních dat bylo zjištěno, že jsou subjekty zapsané v~obchodním rejistříku ze zákona povinny každoročně tyto dva dokumenty odevzdávat pro evidenci státním orgánům. 
Odevzdávají se ve dvou formách. Pvní z~nich je ve formátu PDF na krajský soud, v~jehož obchodním rejistříku je subjekt evidován. Formát PDF je určen spíše ke zpracování člověkem, pro strojové čtení dat není vhodný. Naštěstí pro nás jsou subjekty povinny dokumenty odevzdávat také na daňovém portálu, spolu s~daňovým přiznáním, ve strukturovaném formátu XML. Přestože se v~podnikové sféře používají pro účtování různé nástroje (Pohoda, MRP, \dots), dá se očekávat, že většina z~nich bude schopna tyto dva dokumenty vytvořit ve shodě s~uváděnou specifikací s~názvem DPPDP8, případně nižší verze pro starší závěrky.

Vzhledem k~této skutečnosti bude v~nástroji umožněno automatické načítání těchto souborů implementací odpovídajícího parseru, čímž výrazně usnadníme zadávání. Uživateli bude samozřejmě ponechána možnost hodnotu všech položek rozvahy a~výsledovky vyplnit ručně. Údaje ostatních společností jsou sice zveřejňovány, nicméně už jen ve formátu PDF, pro možnost mezipodnikového srovnání je tedy ruční zadávání dat závěrky nezbytné.

Pro jednoduchost a demonstraci bude evidence výkazů obsahovat maximálně jednu sadu výkazů na jeden rok, pro meziroční srovnání.



%-----
\subsection{Architektura}
Byla zvolena architektura klient-server, s~webovým uživatelským rozhraním. V~dnešní době, kdy je vysokorychlostní internet spíše pravidlem nežli vyjímkou, je tato architektura využívána stále více. Motivací je také fakt, že žádný z~hledaných analytických nástrojů tuto architekturu nevyužívá, přestože ve spoustě jiných oblastí se jedná o~preferované řešení, které uvítají vývojáři a především uživatelé. Existují samozřejmě oblasti, pro které je tato architektura nedostačující. Po prostudování teoretického podkladu této práce si však troufám tvrdit, že v~případě finanční analýzy je toto řešení realizovatelné. 

Webové rozhraní má samozřejmě své výhody -- uživatel může k~programu přistupovat odkudkoliv (také z~různých operačních systémů), používání programu není podmíněno jeho instalací a~z~pohledu vývojáře je mnohem jednodušší jeho údržba (nasazování nových verzí). Další výhodou jsou široké možnosti využití jazyka JavaScript -- nejen v~prohlížeči, ale i na serverech (Node.js) a v~desktopových (Electron) i mobilních (React Native) aplikacích. To signalizuje vysokou míru znovupoužitelnosti napsaného kódu. 

Nevýhodou je samozřejmě nutnost připojení k~internetu, tu však částečně odbourává koncept SPA popsaný v~dalším odstavci a~možnost uložení veškerého kódu spojeného s~aplikací do lokálního uložiště, tato možnost ale nebude součástí základního návrhu. Problémem by se mohlo zdát i prostředí běhu, webový prohlížeč. Efektivita intepretace, nebo spíše překladu JavaScript kódu se však neustále zdokonaluje a~skutečnost, že aplikace není v~nativním kódu, je téměř nepostřehnutelná. 

Nástroj bude koncipován jako single page application (SPA). To znamená, že při interakci s~uživatelem bude stránka překreslována dynamicky na straně klienta, namísto opakovaného nahrávání programového kódu (webových stránek) ze serveru. Tato technika vyžaduje načtení veškerého kódu aplikace při jediném načtení stránky a~dodatečné načítání uživatelských dat ve chvíli, kdy jsou potřeba. Přináší však mnohem plynulejší práci s~uživatelským rozhraním, které se blíží desktopovému provedení -- odezva aplikace se zdá rychlejší, uživatel nemusí čekat při akci vedoucí ke změně UI, která by normálně vedla k~načtení veškerého kódu stránky ze serveru. To je také důvod, proč je SPA v~dnešní době široce využíváno při implementaci rozsáhlejších aplikací nebo systémů běžících ve webovém prohlížeči. 


\begin{figure}
  \centering
  \includegraphics[width=10cm]{img/spa.png}
  \caption{Schéma datového toku single page application (SPA)}
  \label{spa}
\end{figure}

%-----
\pagebreak
\subsubsection{Uživatelské rozhraní}


Uživateli bude umožněno vytoření vlastního účtu pro zpřístupnění rozšířené funkcionality. Přihlášením k~uživatelskému účtu systém pozná, kdo s~ním pracuje. To přináší mnoho možností personalizace a~možnost přizpůsobit obsah dle nastavených předvoleb. Uživatelský účet představuje osobu finančního analytika, manažera nebo podnikatele. S~účtem budou svázana i data za jednotlivá časová obdoví v~minulosti, která lze nahrát a~uchovat pro další použití, například porovnání nebo zpřesnění analýzy v~budoucnu. Bude také zváženo jednorázové zpracování dat pro nepřihlášeného uživatele -- načtení vstupu a~prohlížení výsledků, případně dodatečné upravení vsutpu, který se však po skončení běhu aplikace zahazuje.

Je žádoucí, aby přihlášení přetrvalo mezi jednotlivými chody aplikace, při znovunačtení stránky i při vypnutí a~zapnutí prohlížeče. K~tomuto účelu bude využito lokální uložiště (local storage), které umožňuje zápis limitovaného objemu dat do zařízení klienta. Ukládat se samozřejmě nebude jméno ani heslo, ale takzvaný api token pro komunikaci, který je uživateli udělen serverem po úspěšné autentizaci.

Domovskou stránkou pro přihlášeného uživatele bude obrazovka s~přehledem podniků, které jsou pod jeho účtem evidovány. Podniky mohou být přidávány a~odebírány, slouží především pro seskupování účetních závěrek a jejich následnou analýzou. Po výběru podniku se uživatel dostane na obrazovku s~přehledem nahraných závěrek, přičemž závěrkou se myslí právě výkaz zisku a~ztrát a~rozvaha. Závěrky lze přidávat, odebírat a~upravovat jejich data, v~základu jedna závěrka na jedno účetní období, čili jeden rok. Při přidávání závěrek lze zvolit mezi načtením dat z~XML souboru se strukturou DPPDP nebo ručním vyplněním buněk tabulek. Ty bude použita i pro editaci již nahraných nebo zadaných dat. V~detailu podniku se bude dále možné přepínat mezi jednotlivými druhy analýz nad těmito závěrkami.

Kromě podniků budou pod účtem evidovány také investice. Detail investice bude tvořit jediná obrazovka, na které budou zobrazeny výsledné hodnoty i zadané parametry, které půjde editovat.

Vzhledem k~nejedotné terminologii napříč celou finanční analýzou je žádoucí, aby při zobrazování výstupu uživatel bezpečně zjistil, co se daným pojmem myslí, co daný výsledek reprezentuje. To bude zajištěno výčtem alternativních označení (a možností vložení a~výběru vlastního označení), případně možností přímo přejít do sekce, kde jsou jednotlivé ukazatele detailně vysvětleny. K~tomuto účelu může být použit text z~teoretické části této práce.

Jelikož různé podniky sledují různé ukazatele, je žádoucí, aby nástroj uživateli umožnil vybrat zobrazované/preferované ukazatele. S~podniky a~odvětvími se liší také optimální hodnota konkrétního ukazatele, případně hodnoty hraniční. Tyto hodnoty nelze stanovit obecně, v~literatuře se různí.


\begin{figure}
  \centering
  \includegraphics[width=14cm]{img/gui_mockup.png}
  \caption{Domovská obrazovka, detail podniku a detail investice}
\end{figure}

%-----
\subsubsection{Serverová část}
Serverová část bude sloužit k~uchovávání persisentních dat a~uspokojování požadavků klienta. Persistentními daty jsou vytvořené investice, data investic, podniky, v~rámci podniku nahrané výkazy, rovněž je nutné vést databázi uživatelů samotných.


\begin{figure}
  \centering
  \includegraphics[width=14cm]{img/erd.png}
  \caption{ERD na fyzické úrovni}
\end{figure}

Dále bude server obsluhovat požadavky klienta. Vzhledem k~tomu, že je nástroj koncipován jako SPA (single page application), ke stažení veškerého kódu aplikace ke klientovi bude sloužit jeden jediný endpoint. Klient tak bude moci s~nástrojem pracovat bez dodatečného volání serveru, vyjma operací nad daty, jejichž uložiště ja na serveru. Server bude dále zpřístupňovat rozhraní pro CRUD operace nad těmito daty.

Zda se budou výpočty provádět na straně serveru nebo klienta se rozhodne až při implementaci a~testování. Preferovaný je výpočet na straně klienta, při většině metod analýzy se neprovádějí náročné výpočty a~objem zpracovávaných dat je relativně malý. Přesto je však potřeba dbát na to, aby zátež u~klienta nebyla znát. 



%-----
\subsection{Klíčkové knihovny a~technologie}
K~implementaci bude použita kombinace programovacích, skriptovacích, značkovacích a~dotazovacích jazyků. Pro klientskou část jsou to HTML, CSS a~Javascript (přesněji TypeScript). Kód serveru bude v~jazyce PHP s~připojením na MySQL databázi.


\subsubsection{Typescript}
Jedná se o~nástavbu jazyka JavaScript vyvíjenou společností Microsoft, jejíž hlavním přínosem je statické typování a~další techniky známé z~objektově orientovaného programování -- třídy (ačkoliv ty jsou podle nejnovější specifikace ECMAScript součástí samotného JavaScriptu), rozhraní, moduly a~podobně.

Jelikož se jedná o~nástavbu, lze používat i čistý JavaScript bez použítí typů, což nám umožní použít i knihovny, které jsou implementovány v~čistém JavaScriptu. Otypování kódu však zvyšuje jeho přehlednost, snižuje chybovost, otevírá nové možnosti pro vývojová prostředí (našeptávání, refaktorizace kódu) a~tím zkvalitňuje vývoj. Proto budeme vyvíjet striktně typovaný kód. 


\subsubsection{React}
React je populární frontendová knihovna v~jazyce JavaScript vyvíjená společností Facebook. Jejím jediným cílem je tvorba uživatelského rozhraní pomocí komponent, jejichž kód je zapsán deklarativně -- spíše definujeme, co se má udělat (jak má komponenta vypadat) a~ne jak se to má udělat (to za nás řeší životní cyklus komponent). Při změně modelu, který je uložen v~JavaScriptu, React na základě definice komponent pozná, které komponenty (a na pozadí tedy i uzly DOM) to ovlivní, a~překreslí pouze ty. Velkou výhodou je tedy oddělení modelu od prezentační vrstvy (v~případě jQuery je model uložen přímo v~HTML) se současným použitím deklarativního zápisu. Komponentě poté už jen dodáváme stále nová data.

Systém komponent nás kompletně odstíní od manipulace s~DOM, což bývá v~případě komplexních UI, i s~pomocí jQuery, velmi nepohodlné. Aplikace manipulující přímo s~DOM jsou také velmi náročné na údržbu (změna na jednom místě vede k~změnám na mnoha jiných místech) a~její části hůře znovupoužitelné.

Aplikace se tedy skládá z~komponent. Komponenty jsou do sebe hierarchicky vnořeny, vzniká strom komponent. Pro zápis rozhraní, zanoření i vzhledu komponent se použivá jazyk JSX, což je jakási kombinace JavaScriptu a HTML. Do šablon s~definicí vzhledu za použití HTML jsou interaktivně doplňována data pomocí různých JavaScriptových konstrukcí (iterace, selekce, předávání parametrů apod.). Kromě toho má každá komponenta svůj stav uložený v~proměnné a běžně obsahuje i metody pro obsluhu komponenty, nejčastěji změnu stavu. My se použití stavu komponent vyhneme, namísto toho budeme pracovat s~jedním globálním stavem společným pro všechny komponenty, což je popsáno v~další sekci.


\subsubsection{Redux}
Velkým trendem současných aplikací napsaných s~využitím knihovny React je současné použití knihovny React Redux, což je knihovna Redux přizpůsobená pro integraci do React aplikace. Hned na začátku zmíním, že React a Redux jsou dvě zcela odlišné knihovny, které mohou fungovat jedna bez druhé. Zatímco React je zaměřen na jednoduchou tvorbu komponent uživatelského rozhraní a jejich hierarchizaci v~aplikaci, Redux se spíše zaměřuje na správu dat na aplikační úrovni. Tato knihovna elegantně řeší uložení a práci s~globálním stavem aplikace na základě tří principů:

\begin{enumerate}
  \item \textbf{princip stavu} -- stavový strom celé aplikace je uložen v~jednom \textit{store}\footnote{český ekvivalent by mohl být kontejner}:
    \begin{itemize}
      \item jeden store pro celou aplikaci, rozdělení na úrovni reducerů (viz dále)
      \item stav je imutabilní -- nelze modifikovat, pouze vytvořit nový
      \item lze registrovat funkci pro zavolání při změně stavu (\textit{subscribe})
    \end{itemize}
  \item \textbf{princip akcí} --  stav aplikace lze měnit jen a pouze vyvoláním \textit{akce}:
    \begin{itemize}
      \item akce je vyvolána pomocí funkce \textit{dispatch}
      \item akce má formu Plain JavaScript Object (asociativní pole)
      \item akce obsahuje atribut \textit{typ} a obsahuje také data (pro zpracování reducerem)
    \end{itemize}
  \item \textbf{princip reducerů} -- změna stavu aplikace v~závislosti na akci je popsána v~\textit{reducerech}:
    \begin{itemize}
      \item reducer je čistá funkce (výstup je závislý pouze na vstupních argumentech)
      \item vstupem jsou dva argumenty: současný stav aplikace a vyvolaná akce
      \item výstupem je nový stav aplikace (nemodifikuje současný stav)
    \end{itemize}
\end{enumerate}


\begin{figure}[!htb]
  \centering
  \includegraphics[width=14cm]{img/redux.png}
  \caption{Diagram změny stavu s~použitím knihovny Redux (převzato z~internetu)}
\end{figure}

Pojmem stav aplikace jsou myšlena jak data ze serveru, tak i data lokálního charakteru, například uživatelské vstupy, ve větších aplikacích také veškerá nastavení ovlivňující vykreslování komponent, jelikož s~rostoucí aplikací se tato nastavení zesložiťují. Díky přístupu Reduxu lze se stavem aplikace velmi pohodlně pracovat, za největší výhodu považuji jeho dlouhodobou udržovatelnost. Uložením stavu na jedno jediné místo je ulehčena jeho inspekce a debugování, díky němu je také možné jednoduchým způsobem uchovat stav aplikace pro další spuštění, což významně urychluje vývojářský cyklus, či porovnávat jednotilvé stavy mezi sebou pro sledování změn. 

Princip akcí zase zajišťuje to, že žádný kus kódu nevyvolá změnu stavu jinak než pomocí funkce \textit{dispatch}, které předá objekt akce popisující požadovanou změnu. Tím je zajištěna centralizace provádění změn a lze tak snadno sledovat postupně vyvolané požadavky na změnu stavu. Jelikož jsou akce popsány pomocí Pain JavaScript Object, jsou snadno serializovatelné a mohou tak být zalogovány či uloženy pro pozdější inspekci. 

Při tvorbě reducerů si musíme dát pozor, abychom nemodifikovali stav přímo a nepůsobovali tak tzv. vedlejší efekty (což bychom nejspíš ve spojitosti s~imperativním programováním intuitivně udělali), ale namísto toho vraceli stav nový, s~provedenými modifikacemi. Pokud je tato zásada dodržena při zpracovávání všech akcí, je zajištěno, že pro každou stejnou dvojici argumentů (\textit{stav},\textit{akce}) bude mít funkce stejnou návratovou hodnotu. To je opět výhodné při ladění aplikace, zejména pokud chceme vyzkoušet vyvolání určité akce ve chvíli, kdy je aplikace v~určitém stavu.

\subsubsection{React-Redux}
Pomocí samotného Reactu, bez výhod zmíněných v~předchozí sekci, bychom udržovali stav naší aplikace velmi těžko a zesložitili si tak i vývoj. Knihovna zmíněná v~nadpise nám přináší pohodlné napojení Reduxu do React aplikace, čímž zpřístupní všechny jeho výhody. Pro jeho použití stačí knihovnu naimportovat a obalit vybraný podstrom JSX kódu (obvykle ale kód celé aplikace) elementem, který předtsavuje propojení všech jeho obsažených komponent s~kontejnerem stavu (\textit{store}). Tento element přijímá právě objekt typu \textit{Store}, ve kterém je naše definice stavu pro tento podstrom. Přesněji se jedná o~možnost propojení. Tento úmysl musí být poté ještě u~komponenty explicitně vyjádřen pomocí funkce \textit{connect}. Ta má běžně jeden parametr -- deklarativní popis toho, kterou část kontejneru (které proměnné) chce komponenta sledovat. Propojené komponenty jsou poté automaticky upozorňovány na změny a pomocí deklarativního popisu React komponent se změna stavu odpovídajícím způsobem promítne ve změně uživatelského rozhraní.

Na obrázku \ref{reared} je tok dat aplikací při změně zobrazen graficky. Vzhledem ke stromové hierarchii komponent je tok dat v~běžné React aplikaci jednosměrný, data jsou předávána z~rodičovského uzlu na své potomky. To s~sebou nese jisté nevýhody. Komponenty aplikace jsou sice logicky členěné, pokud však jedna z~komponent iniciuje změnu dat, aktualizace ostatních komponent závislých na těchto datech je prováděna velmi složitou cestou, která musí být v~kódu specifikována. Tento řetězec změn je velmi neprůhledný a může vést k~cyklickým závislostem. Napravo je zobrazen tok dat s~využitím reduxu. Nejprve je pomocí funkce \textit{dispatch} vyvolána změna stavu, na změny jsou poté upozorněny všechny komponenty, kterých se tato změna dotkne.


\begin{figure}
  \centering
  \includegraphics[width=14cm]{img/reactredux.png}
  \caption{Změna stavu react aplikace -- rozdíl bez a s~využitím knihovny Redux \cite{redux}}
  \label{reared}
\end{figure}


\subsubsection{Ostatní}
\begin{itemize}
	\item balík \texttt{react-scripts-ts} -- startovní balík pro urychlení vývoje, obsahuje skripty pro spouštění, ladění, testování a~jednoduché sestavení produkční verze aplikace
	\item Material UI -- sada prvků uživatelského rozhraní, usnadní nám design uživatelského rozhraní, separátně taky sada ikon
  \item React Router -- bude zajišťovat navigaci v~aplikaci, na webové platformě je stav navigace uložen v~URL adrese
	\item Chart.js -- knihovna pro práci s~grafy
\end{itemize} 






%-----
\section{Shrnutí a~další postup}
V~dosavadním textu byly zmíněny základy finanční analýzy podniku -- její definice, praktický i teoretický význam, byla popsána také vstupní data analýzy. Dále byly zmíněny a~popsány pojmy horizontální a~vertikální analýza a~výběr těch nejzákladnějších poměrových ukazatelů spolu se vzorcem výpočtu a~popisem jejich významu. Z~oblasti podnikové analýzy byla zmíněna také analýza peněžních toků a Du Pont rozklad. Z~oblasti investic bylo popsáno vnitřní výnosové procento a sním související čistá současná hodnota.

Ještě před návrhem vlastního programového řešení byl proveden průzkum současných možností v~této oblasti. Na jeho základě byl vypracován vlastní návrh, zohledňující přednosti i nedostatky vybraných nástrojů. Hlavním rozdílem je architektura aplikace (klient-server) a~prostředí běhu (webový prohlížeč). Tento výběr následuje trend moderních aplikací a činí nástroj dostupnějším. Dalším významným rozdílem je výběr technologií, které učiní kód strukturovaným, lehce rozšiřielným, dlouhodobě udržovatelným a~vysoce znovupoužitelným. Co do oblasti finanční analýzy, hlavním rozdílem bude vlastní přístup k~ohodnocení výsledných poměrových ukazatelů i její technické řešení umožňující jednoduchou parametrizovatelnost a rozšiřitelnost analýzy.

Při dalším postupu bude ze všeho nejdříve připraveno vývojové prostředí (devstack). To obnáší instalaci, zprovoznění a~nastavení IDE, serveru, databáze, instalace správce balíčků a~balíčků samotných, vytvoření repozitáře, obstarání testovacích sad. Následně může začít implementace klienta, zcela nezávisle na implementaci serveru. Detaily implementace budou uvedeny dále v~této zprávě.





















































\chapter{Implementace a testování}

V~této kapitole bude popsáno technické řešení nástroje pro provádění finanční analýzy. Nejprve bude probrána implementace činností spojených s~finanční analýzou, poté implementace kódu tvořící kostru nástroje a jejich společná integrace do výsledné aplikace.

\section{Implementace finanční analýzy}
Nástroj bude podporovat většinu typů analýzy zmíněných v~teoretické části. Jmenovitě to jsou: 

\begin{itemize}
  \item podnik (čerpá data z~výkazů účetní závěrky)
  \begin{itemize}
    \item analýza finančních toků (cashflow)
    \item horizontální analýza
    \item vertikální analýza
    \item analýza poměrových ukazatelů
    \item Du Pont rozklad rentab. vlastního kapitálu 
  \end{itemize}
  \item investice (počáteční investice, délka, peněžní toky, diskontní sazba)
  \begin{itemize}
    \item výpočet vnitřního výnosového procenta
    \item výpočet čisté současné hodnoty
  \end{itemize}
\end{itemize}

Tento výběr nám ukládá pracovat se dvěma druhy vstupních dat. Vstupními daty pro analýzu podniku jsou výkazy účetní závěrky podle specifikace daňového portálu, pro investici je to vlastní výběr nejdůležitějších aspektů investice. 

Nejprve tedy specifikujeme struktury pro popis vstupních dat. Implementaci jejich načítání a uložení můžeme odložit na později, z~počátku si vystačíme s~uměle vytvořenými daty. Jakmile jsou struktury specifikovány, můžeme začít s~implementací modulu pro provádění analýzy, jejichž vstupem jsou tyto struktury.

Vzhledem k~rozsahu vzorku podnikových dat, na kterém byla aplikace po celou dobu vývoje testována, jsou podporovány roky 2014 až 2017. Po prozkoumání specifikace struktur z~těchto let si lze všimnout, že nejsou zdaleka identické. Mapování rozdílných struktur finančních výkazů na strukturu společnou pro všechny podporované roky bylo jednou z~největších výzev tohoto projektu. Problém se však podařilo vyřešit, což je popsáno v~následujícím textu. Řešení tak umožňuje sledovat vývoj výsledných položek analýzy podniku napříč všemi podporovanými roky. Po zběžném prozkoumání specifikace starších struktur výkazů jsem došel k~závěru, že díky zvolenému řešení by rozšíření podpory pro tyto struktury nemělo být problémem, stejnětak jako rozšíření pro podporu nových struktur v~budoucnu.

\subsection{Vnitřní reprezentace vstupních dat}
Jelikož jsou vstupními daty finanční analýzy podniku účetní data podniku, která mají oporu v legislativě, budeme dodržovat legislativou stanovený formát. To uživateli nejen zpřehlední jejich zadávání, ale také umožní implementaci jejich automatizovaného načítání dle specifikace DPPDP8. Co se týče investic, zde žádný rozšířený standard není, atributy investice budou zadávány ručně.

Vnitřní reprezenrace vstupních dat nepředstavuje žádnou složitou strukturu. Naopak, všechny potřebné hodnoty, informace a závislosti jsou uloženy jako ploché struktury s jejich výčtem. Vzhledem k nespočtu změn a vyjímek ve specifikaci výkazů z různých let by uložení a popis všech těchto vlastností jednou sofistikovanou strukturou tvořilo tuto strukturu opravdu velmi komplexní. I kdyby se nám podařilo veškerou sémantiku výkazů do struktury zakódovat, takové řešení by nejspíš bylo při další změně legislativy, která je velmi pravděpodobná, velmi těžké modifikovat.

Namísto toho si definujeme pro každou ze specifikací několik jednoduchých struktur pro různé účely a k nim funkce s těmito strukturami pracující. Funkce se strukturou popisují pouze určitou část specifikace v daném roce a tak je možné v nich dělat jednoduše změny, případně implementovat další. Soubor těchto struktur pro určitou specifikaci nazývám \textit{mapa}, o které píšu v další sekci.


\subsubsection{Parsování DPPDP8}
Pro automatizované načítání souborů se syntaxí DPPDP8 pro účely analýzy podniku byl implementován parser. Nejprve je pomocí knihovny fast-xml-parser řetězec s~obsahem XML souboru přetransformován na odpovídající JSON řetězec. Podle tohoto řetězce je vestavěnou funkcí \texttt{JSON.parse()} sestaven odpovídající JavaScript objekt, se kterým můžeme dále pohodlně pracovat tak, jak jsme v~JavaScriptu zvyklí. Každý rok, respektive každá skupina roků se stejnou strukturou výkazů, je načítána pomocí předdefinovaných map. Termínem mapa se zde myslí klasický JavaScript objekt, tedy asociativní pole, které pod daným klíčem obsahuje relevantní informace. Pomocí těchto map se s~výkazy i dále pracuje. Mapa obsahuje následující položky (pro každý výkaz zvlášť):

\begin{itemize}
\item pořadí řádků ve výkazu (reprezentováno polem)
\item označení a plný název položky s~daným číslem řádku (reprezentováno asociativním polem)
\item strom zanoření položek (asociativní pole)
\item mapa pro výpočet položek společných pro všechny struktury výkazů (asociativní pole)
\end{itemize} 

Označení a plné názvy všech položek jsou uloženy v~objektu, jehož klíče tvoří čísla řádků těchto položek, což umožňuje rychlý přístup -- pokud máme k~dispozici číslo řádku, s~nímž chceme pracovat, data spjatá s~tímto řádkem lze získat přímým přístupem do objektu přes daný klíč. Pokud by byly řádky a s~nimi spojená data uloženy v~poli, což se ve spojitosti s~řádky určitě nabízí, pokaždé bychom museli iterovat celým polem, dokud bychom nenarazili na data odpovídající vybranému řádku.

Při práci s~hodnotami, například jejich výpisu do tabulky, je však žádoucí dodržet pořadí stanovené na stránkách daňového protálu\footnote{\url{https://adisepo.mfcr.cz/adistc/adis/idpr_pub/hlib/uv_info/uv_info.faces}}, které bohužel není obecně konzistentní. Například u~tabulky pasiv je běžné, že se mezi prvními položkami s~čísly řádků tvořícími posloupnost přirozených čísel najednou objeví položka s~číslem řádku o~několik desítek vyšším. To je evidentně způsobeno dodatečným přidáváním nových položek. Ty jsou umisťovány k~souvisejícím položkám (nikoliv na konec), nicméně čísla řádků následujících položek zůstávají a tak je nová položka označena úplně novým, nejvyšším číslem řádku. Jinými slovy, atribut číslo řádku položky obecně neodpovídá pořadí položky v~tabulce a tím pádem ani pořadí v~poli.

Mapa s~označením a plnými názvy položek sice obsahuje všechna čísla řádků, jelikož jsou to ale klíče objektu, pro jejich iteraci by se muselo použít konstrukce \texttt{for .. in} (případně \texttt{Object.keys()}), která bohužel v~prohlížeči Chrome nezachovává pořadí, v~jakém jsou klíče zadány. Standard ECMAScript pořadí klíčů při jejich výčtu nijak nespecifikuje \cite{proporder}, to je tak ponecháno na vývojářích. Abychom byli schopni vypsat řádky nejen všechny, ale i ve správném pořadí, obsahuje mapa také pole čísel představující toto pořadí. Na rozdíl od objektu, pole pořadí svých položek zachovává.

Nástroj parametry v~mapě využívá i pro načítání jednotlivých položek výkazů a jejich uložení do vnitřní reprezentace. Tato reprezentace je používána i při ručním zadávání dat, kdy je vytvořen nevyplněný výkaz, respektive výkaz s~nulovými hodnotami pro pozdější vyplnění. Při ručním vyplňování je důležitý i zmíněný strom zanoření, což je popsáno v~následující sekci.

Lze vydedukovat, že rozdílná struktura výkazů v~různých letech bude mít velký dopad na porovnatelnost položek a tedy výpočet významově identických hodnot pro všechny podporované roky. Tento fakt byl jednou z~největších překážek při implementaci. Byla potřeba především nastudovat legislativu k~pochopení těchto změn, vymyslet způsob, jakým vytvářet srovnatelné položky a nakonec jej přepsat do zdrojového kódu. Řešení je popsáno v~sekci \ref{spol}.


\subsubsection{Ruční zadávání dat}
Pro případ, že uživatel nemá možnost dodat výkazová data ve formátu XML, je mu umožněno také ruční zadávání. Hodnoty položek vyplňuje do předchystané tabulky, avšak její naplňování a ukládání hodnot není tak přímočaré, jak by se mohlo zdát. Jelikož jsou výkazy určeny primárně pro zpracování člověkem, jsou v~nich i v~jejich XML reprezentaci uložena redundantní data, zejména hodnoty položek s~hodnotou součtů těchto položek představujících nadřazené položky. 

Po úvaze byla do kódu uložena pro každou ze struktur výkazů také jejich hierarchie, schéma vzájemného zanoření položek. Toto řešení mi přijde vhodné, jelikož při editaci položky be se měla logicky postupně přepočítat i hodnota všech nadřazených položek. Pokud by naopak uživatel editoval neterminální položku, pro udržení konzistence výkazu by bylo nutné navýšit některou z~podpoložek -- neznámo kterou. Do tabulky je tím pádem možné zapisovat pouze listové položky, přičemž dojde k~automatickému přepočtu všech nadřazených položek.

Při nahrávání výkazů není tato technika aplikována, řádky jsou do struktury v~aplikaci nahrány z~XML jedna ku jedné. Informace o~struktuře výkazů a funkce pro výpočet hodnoty nadřazené položky by se v~tomto případě mohlo využít pro zjišťování a následném signalizování nekonzistencí ve výkazu, které by měl uživatel ve vlastním zájmu eliminovat.

Stejně jako musely být všechna čísla řádků, označení a názvy položek uloženy explicitně, tak i strom musí být zapsán v~kódu kompletním výčtem. Při pohledu na finanční výkazy by se dalo usoudit, že je možné jeho automatické vygenerování na základě označení položek. To je však bohužel možné jen do jisté míry, kvůli nekonzistencím tento způsob rozhodně nefunguje pro všechny položky výkazů. Nejsme schopni z~nich odvodit všechny potřebné souvislosti, tj. jaké jsou všechny podpoložky dané položky a zda jsou jednotlivé podpoložky kladné či záporné.


\subsection{Společené položky napříč různými strukturami výkazů}
\label{spol}
Měnící se struktura finančních výkazů v~čase ve specifikaci DPPDP8 byla vzhledem k striktnímu dodržení formátu vstupních dat podle této specifikace jedním z~největších problémů týkajících se finanční analýzy, se kterými jsem se při implementaci setkal. Abychom mohli cokoliv analyzovat a porovnávat výsledky analýzy za různá časová období, je nutné nejprve v~každém z~těchto období získat odpovídající, srovnatelná data. Do roku 2015 včetně, byly změny struktur minimální, zejména se jednalo o~rozpad nějaké ze stávajících položek na více podpoložek. V~roce 2016 však došlo k~významným změnám?, k~přesunům celých položek a především jejich částí pod jiné položky. Některé položky zůstaly nezměněny, u~některých došlo ke změnám, které lze pomocí výpočtu eliminovat a získat tak srovnatelná data pro všechna období, u~ostatních položek změna znemožňuje jejich použití. 


V~mnoha případech jsou položky, u~kterých došlo ke změně, pojmenovány stejně. Nalezení změny tedy spočívá v~porovnání seznamu účtů účetní osnovy použité k~tvorbě dané položky. Kompletní procházení všech výkazů a následné kontroly na změnu nám ulehčí převodový můstek vypracovaný v~Českém účetním standardu pro podnikatele, který lze nalézt přímo na stránkách Ministerstva Financí ČR\footnote{\url{https://www.mfcr.cz/assets/cs/media/Ucetnictvi\_2016\_Ceske-ucetni-standardy-pro-500-2002.pdf}}. Převodový můstek je tabulka s přehledem těchto změn. Její zápis je pro nás velmi ??. Ke každé z položek z nové specifikace je uvedena, tam kde existuje, srovnatelná položka ze specifikace předchozí.

Tam, kde je v~převodovém můstku u~odpovídající položky z~minulých let napsáno kurzívou \uv{\textit{(část položky)}}, máme bohužel smůlu. Změna je totiž na úrovni učetnictví a z~dodaných výkazů není možné vypočítat, o~jak velkou část položky se jedná. Tyto položky tedy musely být úplně vynechány. V~případě ostatních položek byly vybrány či vytvořeny takové, jejichž hodnota půjde v~každém z~roků nějakým způsobem získat. 

Technickým řešením bylo tedy tyto položky stanovit a poté zapsat jejich výpočet pro každou specifikaci zvlášť. Výpočet je realizován opět funkcí a strukturou. Ve struktuře je ke každé z těchto vybraných společných položek uloženo pole kladných a pole záporných položek dané specifikace, výsledek tedy získáme sčítáním a odečítáním položek. Funkce jen proiteruje obě z polí, jejichž sumy od sebe odečte, čímž získáme výsledek.

Tyto společné položky se používají pro všechny druhy analýzy, původní výčet položek v~jednotlivých letech je využit zejména při ukládání, zobrazování a editaci účetních výkazů, pro účely demonstrace také při horizontální analýze. Cílem bylo vytvořit maximální počet společných položek s postupným rozpadem na menší a menší části, čímž se maximalizuje počet různých výpočtů a tím pádem počet výsledků analýzy. Při vertikální analýze je potřeba dbát na to, aby byly vybrané položky vzájemně disjunktní -- počítáme procentuální zastoupení částí na celku a proto by se části neměly překrývat.


\subsection{Provádění analýzy}
Analýzy, jejichž výsledky jsou tabulární data, fungují na podobném principu. Každá z~nich má svůj vlastní popis -- objekt, ve kterém jsou uloženy všechny potřebné informace: seskupování a hirerarchie výsledků, pořadí výsledků, způsob jejich výpočtu, označení a jednotka. Pro práci s~objektem je implementována funkce vykonávající analýzu nad konkrétními daty. Funkce odpovídající objekt systematicky prochází a čerpá z~něj informace pro výpočet, do kterého dosazuje data získané ze svého jediného parametru -- finančních výkazů. Výsledek uloží do struktury opět podle informací z~objektu.

Popisovaný objekt je uložen jako tzv. Plain JavaScript Object, což si lze představit jako jednoduché asociativní pole klíč-hodnota. Tento způsob implementace byl použit na více místech, ?flexibilní, parametrizace, zmenšní? vazby mezi funkcí provádšjící analýzu, kompaktní zápis při rozsáhlém větvení?, prehlednejsi. jednoduche zmeny

* implementace porovnani - prozatim jen horiz a pomer uk, implementace je vsak v~tomto smeru snadno rozsiritelna (id v~objektu)

\subsubsection{Horizontální analýza}
Horizontální analýza je prováděna nad položkamy výkazu zisku a ztráty, aktivy i pasivy. Na nejvyšší úrovni je tato analýza prováděna dvěma způsoby. Ve zdrojovém kódu je uložena informace o~tom, které finanční výkazy mají stejnou strukturu (podle roku). Díky tomu lze uložené výkazy seskupit a provést nad těmito skupinami separátně horizontální analýzu na detailní úrovni -- pro výkazy se stejnou strukturou je analyzována každá z~položek těchto výkazů; potřebné informace, jako jsou názvy, označení a pořadí položek jsou uloženy přímo v~mapě struktury těchto výkazů. Počet skupin se stejnou strukturou je stejný jako počet výsledných struktur. Je to, pro demonstraci, jediná z~analýz, ve které je zohledněna různá struktura výkazů z~různých let (tato skutečnost je zohledněna samozřejmě také v~editoru výkazů).

Tímto způsobem však nejsme schopni analyzovat delší časové období, vzhledem k~podporovaným letem v~implementovaném nástroji jsou to maximálně 2 roky. Abychom mohli analyzovat výkazy v~delším časovém horizontu, využijeme mapy společných položek napříč různými strukturami výkazů. Pro účely horizontální analýzy je nutné definovat v~rámci každého z~výkazů pořadí těchto společných položek. Při výpočtu konkrétních hodnot položek tak stačí nad uloženým pořadím iterovat a přes odpovídající funkce zjistit název položky a vypočítat její hodnotu pro daný rok.

Kromě konkrétních hodnot položek v~daných letech jsou vypočítány i meziroční rozdíly hodnot -- absolutní a relativní (procentuální). Ze vzorce pro výpočet relativního rozdílu vyplývá nutnost explicitně ošetřit prípad, kdy je hodnota položky v~předchozím roce nulová.

$$d_{ABS}=h_{n}-h_{n-1}$$
$$d_{REL}=(h_{n}-h_{n-1})/h_{n-1}$$


Podobně jako u~ostatních druhů analýz, výsledek není uložen v~běžném (indexovaném) poli, nýbrž v~poli asociativním. Nevýhodou je sice nutnost explicitní iterace nad jednotlivými výsledky analýzy, tento způsob uložení je však velmi příznivý při znovupoužití vypočítaných výsledků -- například při výpočtu rozdílu hodnot jedné položky v~různých letech nebo srovnání podniků v~rámci horizontální analýzy. Nejprve se vypočítají výsledky pro všechny srovnávané podniky, poté je nutné podnikové výsledky nahrát do jedné společné struktury. Pokud by byly výsledky pro podnik uloženy v~běžném poli, museli bychom pro každou z~položek respektive pro každý z~analyzovaných roků procházet všechny položky respektive?? roky a hledat mezi nimi ten, který se právě chystáme zpracovat. Díky asociativnímu poli můžeme na hledanou hodnotu přistoupit přímo, přes klíč položky a následně klíč roku, neprobíhá tedy žádné vyhledávání. Přesněji neprobíhá vyhledávání na úrovni naší implementace, ale na úrovni interpretu JavaScriptu.

* Díky této technice bylo v~rámci horizontální analýzy implementováno i mezipodnikové srovnání (dále ještě pro analýzu poměrových ukazatelů).

\subsubsection{Vertikální analýza}
* A, P i VZZ
Při vertikální analýze se nezohledňuje různá struktura výkazů z~různých let, používají se pouze společné položky. Jedna položka vertikální analýzy obsahuje vždy vztažnou veličinu a pole částí, z~nichž je složena a jejichž procentuální zastoupení chceme vyjádřit. Tyto položky jsou obsaženy pro každý z~výkazů - pro aktiva, pasiva a výkaz zisku a ztrát. Při výpočtu algoritmus iteruje nad výkazy, v~rámci výkazů dále iteruje nad položkami. U~každé položky nejprve spočte hodnotu vztažné veličiny, poté hodnotu všech jejích částí, ze které lze vypočítat její podíl na celku.

Jako části byly položky, které jsou vzájemně disjunktní, jinak by se mohlo stát, že suma procentuálního zastoupení všech částí by přesáhla 100\%. Kvůli různým strukturám výkazů a problému nastíněném v~sekci ? je však situace spíš opačná -- některé celky nelze úplně rozložit?.

\subsubsection{Poměrové ukazatele}
Tak jako u~ostatních analýz, i výpočet poměrových ukazatelů je realizován pomocí funkce, která se řídí mapou pro provádění výpočtů? a podle této mapy získává hodnoty z~dodaných výkazů. Mapa na nejvyšší úrovni obsahuje skupiny, či spíše druhy poměrových ukazatelů (rentabilita, likvidita atd.). V~rámci každé skupiny je uloženo pole prvků výčtového typu. Tyto prvky představují konkrétní ukazatele, přesněji jsou to klíče, přes něž lze k~datům spojeným s~daným ukazatelem přistupovat -- momentálně jsou to název a způsob výpočtu ukazatele, klíč je využíván i ke zjištění průměrné hodnoty ukazatele v~odvětví.


\subsubsection{Ohodnocení poměrových? ukazatelů}

Tato volba nám také stanovuje přesný vzorec výpočtu daného ukazatele. V~literaturách se do vzorců 

Pro některé? ukazatele, například ukazatele likvidity, lze najít doporučené hodnoty ve většině zdrojů?. Bohužel jsou tyto hodnoty různé v~závislosti na vybraném zdroji. V~praxi toto platí dvojnásob -- hodnoty ukazatelů mohou nabývat extrémních odchylek, přičemž to nemusí nutně signalizovat špatnou situaci podniku. 

Nejlépe odpovíjdajícími? referenčními hodnotami jsou výsledky finanční analýzy podnikové sféry prováděné Ministerstvem průmyslu a obchodu. 

* nelze rict obecne rict, od jakych hodnot dobre/spatne...? , zejmena u~rentability cim vyssi tim lepsi, ale v~zadnem pripade z~teto hodnoty nelze bez lidskeho faktoru vyvozovat zavery a tedy výslednou hodnotu jednoznačně ohodnotit; naopak, vyvozování závěrů necháme na uživateli, přičemž k~podpoře této činnosti se pokusíme dodat co nejvíce relvantních informací. lze se odrazit od prumeru pro dany obor - dobra vypovidajici hodnota. dale take mezipodnikove srovnani
* zpusob vypoctu jednotlivych ukazatelu se mezi ruznymi zdroji lisi, kvuli implementaci ohodnoceni / srovnani s~prumernymi hodnotami z~MPO bylo pouzito jejich zpusobu
* MPO - pro nektere ukazatele (vetsinu z~vybranych v~tomto reseni) primo hodnoty, pro jine data pro jejich vypocet, pro ostatni ani to ne


\subsubsection{Du Pont rozklad}
Pro implementaci byl z~pyramidových rozkladů vybrán rozklad rentability vlastního kapitálu. Většina prvků rozkladu jsou hodnoty již zmíněných ukazatelů (ukazatele představují uzly diagramu) či položek finančních výkazů (položky představují listy diagramu). Přesto byl pro tuto analýzu vytvořen separátní modul. V~něm jsou doplněny především metody pro výpočet ukazatelů, které nebyly implementovány v~rámci analýzy poměrových ukazatelů. Modul funguje také jako mezivrstva -- pokud bychom chtěli výslednou hodnotu ukazatele upravit speciálně pro účely Du Pont analýzy, nebo ji doplnit o~další informace, můžeme to udělat zde. 

Jelikož jsou při grafické interpretaci pyramidového rozkladu zobrazeny také matematické vzorce pro výpočet jednotlivých uzlů, v~modulu jsou uloženy i tyto vzorce. Rovnice a funkce vyčíslující výsledek jsou však uloženy zvlášť, lepším řešením by mohlo být uložení vzorce do abstraktního syntaktického stromu, což by umožnilo čerpat vzorec i výsledek výpočtu z~jednoho zdroje.

* svg

\subsubsection{Analýza cashflow}
Jelikož tato implementace dále s~výsledky cashflow analýzy nepracuje, jsou pro usnadnění práce při jejich vykreslování uloženy v~běžném poli. Mnoho vzorců z~oblasti poměrových ukazatelů lze však změnit dosazením výsledků analýzy cashflow namísto stávajících členů, čímž získáme zase další užitečnou vypovídající hodnotu. Po přepracování struktury výsledků cashflow analýzy, zejména jednoznačným označením jednotlivých položek, lze nástroj rozšířit o~další typy ukazatelů.

Dosavadní implementace umožní analytikovi sledovat peněžní toky za různá období. Tok nese kromě hodnoty také informaci o~tom, proč vůbec vznikl a dále je také zařazen mezi jednu ze tří klíčových činností. Samozřejmě je vyčíslena i suma toků pro každou z~činností a celková suma toků.

\subsubsection{Analýza investice}
\label{irr}
Vstupem pro všechny doposud zmíněné analýzy jsou roční výkazy podniku -- rozvaha a výkaz zisku a ztrát. Pro výpočet vnitřního výnosového procenta určité investice či projektu se však používají spíše peněžní toky výhradně s~ním spojené. Prvním pěněžním tokem obvykle bývá počáteční investice, která je intuitivně evidována zvlášť. Zbývající pěněžní toky je nutné začlenit do období, ve kterém proběhnou, určit jejich hodnotu a pro vlastní potřeby také jejich účel.

Výpočet NPV je přímočarý, spočívá v~pouhém dosazení do vzorce. Analytické řešení výpočtu VVP však není známé?, budeme jej řešit numericky. 
* krome irr i npv - uzce spolu souviseji, pri vypoctu irr je pouzito vzorce npv
* npv i irr - pocitat pro vsechny roky, nejen pro posledni - taky do rozsireni
* metoda puleni intervalu



\section{Implementace nástroje}

\subsection{Datoý tok}
Při implementaci architektury a persistence dat jsem se mírně odchýlil od návrhu. Původním záměrem byla implementace vlastní serverové části s napojením na MySQL databázi. Po přezkoumání možností mi přišlo výhodnější využít služby Firebase poskytované společností Google. Činnosti jako instalace, konfigurace, zprovoznění a implementace vlastního serveru a jeho další úpravy při změnách na straně klienta by přinesly poměrně velké množství práce navíc, přičemž způsob technického řešení nástroje není předmětem zadání.

Jak je vidět na obrázku \ref{spa}, serverová část v mém návrhu měla sloužit pouze pro stažení kódu aplikace při jejím spuštění a dále už jen pro manipulaci s uloženými uživatelskými daty. Přesně toto nám umožňuje služba Firebase, která poskytuje jak hostování kódu aplikace, tak přímý přístup na databázi. ???dotazy v app, skoro jak sql, jen nad strukturami/kolekcemi (docs, collection), objektova db???. Z uvedeného popisu vyplývá, že mezi klientskou částí aplikace a databází není žádná programovatelná vrstva -- server, na kterém bychom chtěli spouštět svůj vlastní kód. I pro tento problém má Firebase řešení, službu Cloud Functions. My jej však nevyužijeme, jelikož se ukázalo, že provádění veškerých implementovaných operací u klienta nepředstavuje výkonnostní zátěž.

- objektove schema pouzivane databaze (asi jen json)

Dalším velkou výhodou služby Firebase je správa uživatelů aplikace a zajištění procesu autentizace. Přes funkce poskytované knihovnou je tak možné velmi jednoduše vytvářet nové uživatelské účty či zajistit celý proces automatického přihlášení, tedy i jeho persistence. Tato služba v oblasti autentizace a autorizace nabízí mnohem více, my se však omezíme na funkcionalitu, kterou jsem zmínil. Posledním důležitým prvkem je jednoznačný uživatelský identifikátor, který je automaticky vygenerován při vytvoření uživatelského účtu. Ten slouží jako klíč v databázi, pod kterým jsou uložena veškerá data spojená s tímto účtem -- podniky a investice. 

Při přihlášení uživatele dojde ke stažení těchto dat do reducerů?. Všechna uložená vstupní data jsou tak dostupná přímo v aplikaci, uživateli jsou zpřístupněny podniky či investice, které může analyzovat a editovat. Při jejich editaci dojde nejprve k zápisu změny do databáze, poté jsou z ní znovu načteny všechny podniky či investice. Řešení je sice velmi neúsporné s ohledem na nadbytečné využití prostředků, je to však nejjednodušší způsob synchronizace databázových a aplikačních dat. Pokud by měl být nástroj nasazen, bylo by vhodné objem přenesených dat minimalizovat. 

* kazda analyza - pri vykresleni prislusne obrazovky se nastroj pokusi o~analyzu, v~pripade neuspechu ulozi error, ktery pak prislusna komponenta vykresli

Proces výpočtu a zpracování výsledků je téměř u všech analýz stejný, liší se pouze způsobem výpočtu. Tento proces je prováděn speciálním objektem, který jsem nazval \textit{data manager}.

\subsection{Uživatelské rozhraní}

Prostředím běhu aplikace je webový prohlížeč, aplikace byla vyvíjena primárně pro Google Chrome. Vzhled aplikace definují jazyky HTML a CSS, kód je však psán v~jazyce JSX. Ten je syntaktickým rozšířením jazyka JavaScript umožňujícím v~kódu pracovat s~šablonou jako s~proměnnou Javascriptu, přičemž šablona má podobu kódu HTML ve kterém je možné použít JavaScriptové konstrukce pro iteraci, selekci a podobně. Před vykreslením je JavaScriptový kód interpretován a konečný vzhled odpovídajícím způsobem sestaven.

Použití samotných prvků HTML bez dodatečného nastylování je k~tvorbě vzhledných aplikací nedostačující, což je nejspíše způsobeno prapůvodním záměrem tohoto jazyka. Design webových stránek nebo aplikací je však poměrně rozsáhlá oblast, bylo proto vhodné sáhnout po knihovně hotových, nastylovaných prvků. Z~počátku byla zvažována knihovna Bootstrap, nakonec jsem se rozhodl pro modernější knihovnu Material UI.

S~touto knihovnou je možné tvořit aplikace s~, které ?? po designové stránce.

Výsledkem většiny analýz jsou tabulární data, sledujeme vývoj souboru položek analýzy v různých letech. Při výběru některé z položek je zobrazen její detail, který obsahuje vhodný graf zobrazující současnou situaci či vývoj položky. Pro vykreslování a práci s grafy byla použita knihovna Chart.js


* material design google - sada ikon

\subsubsection{Navigace}
Aplikace je v~souladu s~návrhem koncipována jako single page application. Pokud uživatel přistoupí na rootovou adresu aplikace s~jakýmkoliv suffixem, server vždy vrátí kód představující celou aplikaci, což vyžaduje jeho konfiguraci. Jelikož je tentot typ aplikací mezi webovými aplikacemi poměrně rozšířený, možnost tohoto nastavení je zpřístupněna v~samotném průvodci konfigurací firebase. Suffix adresy tak není zpracováván serverem, nýbrž aplikací na straně klienta, jedná se tedy o~client side routing.



Pro tento účel byla použita knihovna React Router. Pro uspořádání obrazovek a pohyb mezi nimi bylo využito knihovny React Router.

Části URL adresy odpovídají architektonickým vrstvám aplikace, lze podle nich zjistit, s~jakými entitami pracuje.

routovani (navigace):
* client side routing - url zpracovava aplikace (knihovna), nevyhody vyhody najit na netu, prohlizec nenajde jednotlive komponenty - jen hlavni
* obrazovky + url
* url vpodstate udava stav aplikace svym tvarem (vime, kterou obrazovku zobrazit + id atd), spustenim aplikace s~urcitym url ji vlastne spoustime v~urcitem stavu, do url se da ulozit vpodstate cokoliv, my se omezime na prepinani obrazovek a predavani idcek

\subsubsection{Obrazovky}

Po spuštění aplikace se uživatel musí přihlásit, zobrazeno je pouze modální dialogové okno pro vyplnění přihlašovacích údajů nebo registraci. Při úspěšném přihlášení je přesměrován na hlavní obrazovku a je mu zpřístupněna fixní horní lišta aplikace, která slouží jako navigace. V~liště je také tlačítko pro odhlášení. Na domovské stránce se lze pomocí horní lišty přepínat mezi dvěma obrazovkami -- seznamem podnků a seznamem investic.

Po výběru investice ze seznamu je uživatel přesměrován do detailu investice, kde je možné nastavit její parametry -- počáteční rok, velikost počáteční investice a při výpočtu čisté současné hodnoty i hodnotu úrokové sazby. Nezbytnými parametry jsou také peněžní toky v~jednotlivých časových obdobích, uživateli je tak umožněno přidávat další roky trvání investice, v~rámci nichž zadává libovolně pojmenované výnosy a výdaje. Pokud jsou zadány nevyhovující parametry, je uživatel upozorněn. Pokud jsou k~dispozici výsledky, může přepínat mezi zobrazením hodnoty čisté současné hodnoty a vnitřního výnosového procenta.

Na obrazovce se seznamem podniků jsou vykresleny karty s~jednotlivými podniky a tlačítko pro možnost přidání nového podniku. V~rámci konkrétního podniku lze pokračovat na seznam jeho evidovaných výkazů, jednu z~obrazovek s~analýzou nebo na obrazovku srovnání. 

Na obrazovce se seznamem výkazů se lze přepínat mezi výkazy z~různých let, případně výkaz smazat nebo přidat nový, což je nezbytný krok i při importu dat. Na kartě s~výkazem lze ručně vyplnit údaje nebo použít tlačítko pro import. Výkazem se zde rozumí trojice dokumentů -- výkaz zisku a ztrát, tabulka aktiv, tabulka pasiv.

Pokud jsou nahrány potřebné výkazy, lze se přepínat mezi obrazovkami s~analýzou. Výsledkem všech analýz, až na rozklad Du Pont, jsou tabulární data. U~horizontální a vertikální analýzy jsou to tři sady tabulárních dat podle rozdělení na výkaz zisku a ztrát, aktiva a pasiva, přepínat se lze pomocí tabů. Při výběru položky horizontální analýzy je zobrazen sloupcový graf s~hodnotami ve všech zaznamenaných letech. Při výběru položky na obrazovce vertikální analýzy je zaznamenán celek, do kterého položka patří, a také rok, který nás zajímá. Zobrazen je koláčový graf ilustrující rozložení celku na části v~daném roku. Obrazovka s~analýzou poměrových ukazatelů obsahuje všechny skupiny ukazatelů i jejich položky v~jedné tabulce. Pro vybranou položku je zobrazen sloupcový graf. U~položek, jejichž průměrná hodnota v~odvětví je známa a zadána, jsou tyro průměrné hodnoty zobrazovány vedle hodnot vypočítaných pro vybraný podnik.

Na obrazovce s~analýzou Du Pont jsou data reprezentována jako vizuální rozklad. Výstup analýzy by mohl být reprezentován i tabulkou či rovnicí, zvolený způsob je ale dle mého názoru mnohem názornější a je také použit v~mnoha studovaných zdrojích. Vizualizací stromu rozkladu jsou obdélníky s~prvky rozkladu, terminálními i neterminálními, propojené čarami. Vizualizace je realizována pomocí jazyka SVG, který je ve většině webových prohlížečů podporován. Proporce vizuálních prvků jsou uloženy v~proměnných, ty jsou na sobě relativně závislé. To umožňuje jednoduchou škálovatelnost výsledného zobrazení.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=13.5cm]{img/screens.png}
  \caption{Diagram návaznosti obrazovek aplikace}
\end{figure}

\section{Testování}

\section{Vývoj}
Pro ověření správnosti navrženého řešení byl v~každé z~oblastí finanční analýzy nejprve implementován prototyp se zúženým výběrem analyzovaných položek a omezenou funkcionalitou. Úplné doplnění položek a funkcionality proběhlo až v~dalších fazích implementace, stejnětak jako opakovaná refaktorizace. Tento postup byl zvolen i při implementaci persistence dat. Ve zdrojovém kódu je možnost volby mezi čerpáním uživatelských dat z~databáze, nebo jejich podvržením pomocí definice jednotného rozhraní těchto dat. Pokud zrovna neimplementujeme modul zajišťující persistenci dat, využití podvržených dat je velmi výhodné z~důvodu urychlení vývojářského cyklu a možnosti vyvíjet bez připojení k~internetu.

Jako vývojové prostředí bylo použito IDE WebStorm od společnosti JetBrains, jehož licence je poskytována studentům zdarma. Kromě mnoha dalších, nástroj má podporu pro všechny technologie využité při implementaci a jejím usnadnění, zejména jazyky JavaScript, TypeScript a JSX. Celý projekt byl průběžně verzován pomocí nástroje Git, jež má ve zmíněném IDE také grafické rozhraní.

Po stažení složky s~projektem z~repozitáře je pro vývoj nezbytná instalace závislostí. Po spuštění skriptu je rozhraní aplikace otvevřeno v~prohlížeči.

$$\texttt{npm run install \&\& npm run start}$$

Tento příkaz zůstává spuštěn?XXX?, na pozadí běží kontrola na změny souborů se zdrojovými kódy, TypeScript watcher. Při změně je TypeScript kód automaticky překompilován na JavaScript kód, poté je kód dále transformován, například pro funkčnost v~co nejvíce prohlížečích či jejich verzích. Po doběhnutí dojde ke znovunačtení aplikace v~prohlížeči -- aktualizace stránky. Díky knihovně React Router, která pro navigaci využívá URL adresu, se při aktualizaci stránky stav navigace uchová a aplikace se spustí na původní obrazovce, pouze si znovu načte vykreslovaná data. Watcher funguje i při testování, stačí tedy uložit zdrojové kódy a příslušné testy se spustí znovu.

Zkompilování kódu do balíčku pro nasazení je prováděno příkazem \texttt{npm run build}. Po správné konfiguraci nástroje firebase je možné aplikaci jednoduše nasadit do provozu na veřejné adrese pomocí příkazu \texttt{firebase deploy}.



* vsechny knihovny pres npm, jejich seznam v~package.json


\section{Možnosti rozšíření nástroje}

Vzhledem k~tomu, že se způsoby výpočtu některých ukazatelů v~různých literaturách liší, bylo by vhodné uživateli zobrazit způsob výpočtu, který je použit v~tomto nástroji. Při současné implementaci se jeví jako nejjednodušší řešení ke každé metodě provádějící výpočet přiřadit také popis výpočtu, například ve formě řetězce. Popis výpočtu a výpočet samotný by však nevycházely ze stejného zdroje a nebyly tak sémanticky propojeny, vývojář by musel při každé změně algoritmu pro výpočet adekvátně měnit popis. Vzhledem k~tomu, že se jedná o~víceméně jednoduché matematické rovnice, nabízí se mnohem lepší řešení -- uložit rovnice pro výpočet do odpovídajícího abstraktního syntaktického stromu (AST). Tato struktura by umožnila obojí -- vypočítat výsledek i vygenerovat popis výpočtu a jeho složek na základě jednotného zdroje. Tento způsob by také otevřel další možnosti rozšíření, pomocí vhodného rozhraní by uživatel mohl editovat vzorce existujících ukazatelů podle svých potřeb či vytvářet úplně nové.

Nástroj pro jednoduchost podporuje pouze meziroční analýzu. Lze však vyvodit, že se v~praxi může provádět analýza obecně různých časových obodbí. K~částečnému zkvalitnění tohoto rozšíření by se dalo použít i dat z~analýzy podnikové sféry prováděné MPO, která uvádí statistiky kvartálně (momentálně jsou využity pouze roční statistiky).

Ve statistikách MPO jsou uvedeny také oborové sumy za většinu hlavních položek finančních výkazů. Porovnáním adekvátních položek (částí k~celku) by bylo teoreticky možné zjistit průměrné oborové hodnoty v~rámci vertikální analýzy a tyto v~nástroji uvést. Dále je ve statistikách uveden také počet podniků v~odvětví, vydělením sumy položky počtem podniků by tak šlo získat průměrnou hodnotu položky pro dané odvětví -- průměrné hodnoty pro horizontální analýzu. V~souvislosti s~daty MPO by se také nástroj dal rozšířit o~práci se zbývajícími poměrovými ukazateli, pro které jsou uváděny průměrné hodnoty v~odvětví, nebo alespoň hodnoty potřebné k~jejich výpočtu.

Jelikož jsou tyto statistiky uloženy jako velmi rozsáhlá tabulární data programu Excel, ruční výpočet a zapisování do zdrojového kódu je velmi zdlouhavé. To může být vyřešeno automatizovaným zpracováním těchto souborů či umožněním uživateli vyplnit hodnoty v~případě jeho zájmu.

Z~oblasti finanční analýzy se dále nabízí rozšíření importu o~zkrácené výkazy, účelové členění nebo možnost čerpat zdrojová data přímo z~účetnictví (nikoliv z~účetní závěrky), pokud existuje nějaký standardizovaný formát exportu těchto dat. To by umožnilo ještě detailnější analýzu. Nebo naopak, umožnit uživateli vyplnit pouze data nezbytná k~výpočtu ukazatelů a nenutit jej tak nahrávat celé výkazy, které ani nemusí mít k~dispozici. Kromě zobrazování referenčních hodnot by nástroj také mohl hlásit evidentní rizikové faktory, jako příklad můžeme uvést hospodaření se ztrátou. Díky způsobu implementace a struktury výsledků jednotlivých analýz je nástroj připraven pro širší záběr v~rámci mezipodnikového srovnání rozšířením modulu na práci se všemi druhy podporovaných analýz.



* vice roku - nemoznost zobrazit vse - vymyslet, jak by se to dalo zobrazovat
* relační databáze (mysql) namísto objektové - větší kontrola při změnách aplikace
* výkon - ulozeni vysledku analyzy a jejich sprava, aby se nemuselo pocitat pri kazdem spusteni aplikace
* lepsi cache dat - pokazde se vse znovunacita pro jednoduchost
* jine ukazatele, rozsireni analyzy podniku i analyzy v~oblasti investic
* scrolovani tabulek scrolluje celou stranku - vylepsit layout

* pro usnadneni ovladani: offline?, cashflow - preddefinovane polozky, razeni / vyhledavani v~tabulkach, uzivatelske preference
* samozrejmost - dukladnejsi osetreni uzivatelskych vstupu
* v~dalsim roce se muze opet menit legislativa - aktualizace kodu

\begin{comment}
\chapter{Testování}
\section{??? nejake bezne testovani}
\section{Demonstrace na zvoleném vzorku dat}
\end{comment}

\section{Demonstrace na vybraném vzorku dat}
Firma, na které aplikuji ve své diplomové práci finanční analýzu, je firma Krajči plus s. r. o. Jedná se o~ryze českou společnost, která byla založena již v~roce 1995. Společnost začínala
jako malý regionální výrobce, který dodával své výrobky do blízkého okolí. Postupem času se této společnosti podařilo stát soběstačnou a prosperující firmou ve své oblasti. Do konce roku 2013 podnikala firma jako fyzická osoba, nevedla tedy účetnictví. V~roce 2014 se majitelé rozhodli, že firma změní právní formu na společnost s~ručením omezeným. Od tohoto roku jsem podrobil firmu Krajči plus s.r.o. finanční analýze a jsem přesvědčen, že i do budoucna bude firma mé metody finanční analýzy využívat.

Firma podniká v~potravinářském oboru, zabývá se jednak výrobou bramborových lupínků a krekerů a jednak nákupem a prodejem zboží – tyčinek a suchých plodů. Ve firmě probíhá celý výrobní proces, počínaje nákupem surovin až po distribuci obchodním partnerům – společnost distribuuje své výrobky po celé České a Slovenské republice. Vedení společnosti se zavazuje k~neustálému zlepšování efektivnosti řízení i zvyšování kvality produktů. Tímto zlepšováním jsou míněny jak technologické inovace, které vyžadují nové a nové investice, tak přehodnocování a zkvalitňování jednotlivých procesů ve vedení, výrobě a ve vztazích s~odběrateli a dodavateli.

Výsledky finanční analýzy jsou srovnávány s~doporučenými hodnotami v~daném odvětví podle klasifikace ekonomických činností (CZ – NACE), které jsou závazné jak pro orgány vykonávající státní statistickou službu, tak pro zpravodajské jednotky, které poskytují údaje pro statistická zjišťování prováděná státní statistickou službou patří firma do sekce zpracovatelského průmyslu, konkrétně do části „Výroba potravinářských výrobků“. Analyzovaná společnost Krajči plus s. r. o. dosáhla ve sledovaném období 2014 – 2017 nadprůměrných výsledků. Provozní výsledek hospodaření, který je pro firmu výrobního typu tou nejvýznamnější složkou, se za celé sledované období více než zpětinásobil. Finanční výsledek hospodaření, který je ovlivněn nákladovými úroky a ostatními finančními náklady je po celou dobu sledovanosti mínusový, ale v~žádném případě neměl zásadní vliv na celkový hospodářský výsledek ani v~jednom ze sledovaných roků. Hospodářský výsledek, který je hlavním stavebním kamenem v~celé řadě ekonomických ukazatelů, je podmíněn růstem tržeb. Dokladem expanze na potravinářský trh je viditelný růst prodeje zboží z~původních 5 496 mil Kč v~roce 2014 na 13 168 mil. Kč v~roce 2017 a růst prodeje vlastních výrobků z~původních 28 770 mil. Kč v~roce 2014 na 99 931 mil. Kč v~roce 2017.
Ukazatelé rentability ve sledovaném období nás ujišťují o~tom, že ve firmě Krajči plus s.r.o. jsou velmi efektivně zhodnocovány prostředky, které firma do podnikání vložila, bez ohledu na to, jestli se jedná o~vlastní nebo cizí zdroje. Rentabilita vlastního kapitálu, která nás samozřejmě zajímá nejvíc je ovlivňována právě kumulací zisku, který je výsledkem hospodaření minulých let. Čím vyšších hodnot rentability je dosahováno, tím je podnik považován za úspěšnější. Vidíme, že hodnoty ukazatelů se ve všech případech pohybují nad odvětvovým průměrem. Pokud se podíváme na rentabilitu tržeb, vidíme že z~jedné koruny tržeb firma dosahuje na počátku podnikání 0,1498 zisku . V~roce 2017 je to již hodnota 0,2452 , což svědčí o~výborných výsledcích.

Co se týče ukazatelů likvidity a zadluženosti, které jsou ostře sledované konkurencí a bankovními institucemi, které jsou věřiteli firmy, lze říci, že zejména likvidita prvního stupně – tzv. okamžitá likvidita se za sledovaná léta zvýšila více než trojnásobně ( z~0,66 na 2,07), přičemž minimální doporučená hodnota pro potravinářskou výrobu je 0,16. Likvidita druhého a třetího stupně, která je při ukončení činnosti firmy daleko hůře proveditelná, se v~tomto případě pohybuje také v~červených číslech a nad doporučenými hodnotami. Ukazatelé zadluženosti nám přinášejí informace o~úvěrovém zatížení a o~jiných závazcích společnosti. V~našem případě je zřejmé, že celkový vlastní kapitál převyšuje hodnotu cizích zdrojů. Vyjímkou je samozřejmě rok 2014, který se datuje jako počátek podnikání nové právní formy společnosti a v~tomto roce se poprvé vytváří čistý zisk, který ovlivní výši vlastního kapitálu až v~roce 2015. Z~výše uvedeného vidíme, že kromě startovacího roku 2014, jsou poměry cizího a vlastního kapitálu naprosto v~pořádku. 
Pokud bych shrnul výsledky finanční analýzy sledované firmy v~období od 2014 – 2017, hodnoty všech
ukazatelů se pohybují bezpečně nad hranicemi doporučených hodnot. Tím se společnost jednoznačně řadí mezi finančně zdravé podniky.



* horizontalni analyza - da se rict ze vsechny polozky rostou, nicmene pro podnik kladne polozky rostou rychleji nez zaporne a tak podnik generuje stale vetsi zisk 

* vzz - rostouci trzby a tim padem obrat, s~nimi ale samozrejme i rostouci naklady. Vynosy vsak rostou rychleji a tak vysledek hospodareni vykazuje rust, v~poslednich trech letech se pokazde zhruba zdvojnasobil.

* to same i u~celkovych aktiv, u~pasiv si lze vsimnout predevsim obrovskeho narustu hodnoty dlouhodobych zavazku v~roce 2016.
%_-----------------------------------------------
* slozeni aktiv na nejvyssi urovni vicemene stejne - 1/3 dlouhodoby majetek, 2/3 obezna
* dlouhodoby - pouze hmotny, neeviduje zadny nehmotny ci financni
* ani struktura obeznych se prilis nemeni, zasoby tvori asi 10 procent, zbytek je zhruba stejnymi dily rozdelen mezi kratkodobe pohl a penezni prostredky.

* co se tyce pasiv, rozlozeni na nejvyssi urovni lze sledovat spise pomoci ukazatelu zadluzenosti (jsou zde pouze vlastni a cizi kapital)
* veskere cizi zdroje jsou zavazky uverovym institucim, v~prvnich dvou sledovanych letech vyrazne prevazovaly kratkodobe, v~dalsich dvou letech je hodnota kratkodobych skoro rovna hodnote dlouhodobych

* co se tyce vynosu za sledovane obdobi, vetsinu z~nich (80 a vice procent) tvori trzby za prodej vyrobku a sluzeb, zbytek je z~prodeje zbozi. Naklady jsou rozdeleny mezi vsechny podpolozky, nejvetsi cast tvori polozka \uv{Spotřeba materiálu a energie}
%_-----------------------------------------------

%%************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************
\chapter{Závěr}
V~rámci této diplomové práce se podařilo implementovat prakticky využitelný nástroj umožňující provádět vybrané úkony z~oblasti finanční analýzy. Implementaci předcházelo studium problematiky finanční analýzy i průzkum současných softwarových možností jejího provádění. Na základě zjištěných poznatků byl vypracován návrh vlastní programové koncepce, který byl poté realizován. Nástroj se zaměřuje na analýzu dvou entit, podniku a investice, přičemž se snaží k~vytvoření závěrů o~situaci analyzovaných entit poskytnout co nejužitečnější informace.

Nad podnikem umožňuje provádět analýzu horizontální a vertikální, analýzu poměrových ukazatelů, analýzu peněžních toků a rozklad Du Pont. Pro vybrané analýzy umožňuje také mezipodnikové srovnání. Ve stěžejní oblasti, za kterou považuji analýzu poměrových ukazatelů, byla realizována možnost porovnání výsledků s~celorepublikovými průměry v~odvětví. Pro investici umožňuje nástroj výpočet její čisté současné hodnoty a vnitřního výnosového procenta.

Cílovou skupinu nástroje tvoří podnikatelé a finanční analytici, jimž se snaží práci maximálně usnadnit. Prostředím běhu je webový prohlížeč, což umožňuje nástroj používat odkudkoliv, bez nutnosti jeho instalace. Dodržování požadavků plynoucích z~legislativy ČR zajišťuje jednoznačnost při zadávání vstupních dat i možnost jejich automatizovaného načítání. Díky podpoře uživatelských účtů je možné nahraná data s~uživatelským účtem spojit, uložit a k~analýze se opakovaně vracet.

Řešení je kvalitní nejen z~pohledu provádění finanční analýzy a uživatelské přívětivosti, ale i z~pohledu vývojáře. Díky použitým technologiím a způsobu implementace je zdrojový kód především robustní ke změnám a tím pádem dlouhodobě udržitelný, což je pro budoucí vývoj, zejména v~oblasti finanční analýzy, obrovskou výhodou.






\begin{comment}

766F6A74617065747231393439

**
Jedna se
o~ačkoliv
položka
mapa
různ odliš (z~ruznych zrdoju / literat ruzne hodnoty)
router
JavaScript
TypeScript
zejmena
predevsim
diky
na zaklade
vzhledem
odpovidajic
rovnice -> vzorec
respektive
napric
hned - smazat
co nejvic -> maximalne
pouze, jen
však
**

* TESTY
* muzu dat vykazy do prilohy? je to vubec potreba? je to napsane v~uvodu, ze to tam bude
* predelat ERD, doplnit investice
* ucd - extend
* diagram obrazovek - dve sipky, jedna na detail, druha zpet na prehled podniku
* impl - nejvetsi prekazdou menici se legislativa a závsle na ní i specifikace, pouze ceska legislativa

aktiva: 
	17+16;
	15+14 +13[nazvy]+12+11+10[nazvy]

pasiva:
	17+16;
	15+14 +13[nazvy,radek_58_chybi]+12[radek_57_chybi]+11[radek_56_chybi]+10[nazvy]

vzz:
	17+16;
	15+14 +13[nazvy]+12+11+10


interface ICompany {
    id: string
    name: string
    czNaceId: string
    docs: IDoc[]

}

interface IDoc {
    id: string
    year: number
    tables: {
        aktiva: { [c_radku: number]: number }
        pasiva: { [c_radku: number]: number }
        vzz: { [c_radku: number]: number }
    }
}


\end{comment}

